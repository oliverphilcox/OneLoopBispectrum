(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    316808,       8326]
NotebookOptionsPosition[    308394,       8186]
NotebookOutlinePosition[    308754,       8202]
CellTagsIndexPosition[    308711,       8199]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "This notebook contains the FFTLog kernels and limits necessary for \
computation of the one-loop bispectrum of galaxies in redshift-space \
including all fourth-order biases. Here, we specialize to flat configurations \
with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["k", "1"], " ", "=", " ", 
    RowBox[{
     SubscriptBox["k", "2"], "+", 
     SubscriptBox["k", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "bd84113d-4e59-4065-b8ba-df3bc4429915"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "1"], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["\[Mu]", "2"]}], "-", 
     SubscriptBox["\[Mu]", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "6b9cbafa-5ac8-401f-88d3-3854b676db67"],
 " (and permutations thereof). We will leave both x and y in the kernels to \
facilitate applying symmetries later."
}], "Text",
 CellChangeTimes->{{3.854491260769767*^9, 3.854491294882153*^9}, {
   3.854617537419744*^9, 3.8546175401154137`*^9}, {3.859276802018355*^9, 
   3.859276819016983*^9}, {3.861713611031365*^9, 3.861713640757554*^9}, 
   3.861713755290032*^9},ExpressionUUID->"394eb258-9a60-49a5-8d1e-\
561b69b7a771"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", " ", "Output"}]}]}]}]}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Directory", " ", "--"}], "--"}], "--"}], "--"}], "--"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "workdir", " ", "=", " ", 
     "\"\</Users/ophilcox/Desktop/OneLoopBispectrum/kernels\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "workdir", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85927686767559*^9, 3.8592768725827923`*^9}, {
  3.859624273307703*^9, 3.859624273368657*^9}, {3.8598840745092487`*^9, 
  3.859884074558436*^9}, {3.861705283443632*^9, 3.861705298336368*^9}, {
  3.861713881340354*^9, 3.861713886106221*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"c10a3ab8-894b-4555-bd84-11442c651e8e"],

Cell[CellGroupData[{

Cell["Set-Up", "Section",
 CellChangeTimes->{{3.861705604856881*^9, 
  3.861705605620727*^9}},ExpressionUUID->"eb149da2-3853-4ba3-94c1-\
468001582704"],

Cell[CellGroupData[{

Cell["Define PT kernels", "Subsubsection",
 CellChangeTimes->{{3.634475906964828*^9, 3.634475912040431*^9}, {
   3.634481722855845*^9, 3.6344817435038652`*^9}, {3.639250662964822*^9, 
   3.63925066905814*^9}, {3.639583496454501*^9, 3.639583503929502*^9}, {
   3.640095949461132*^9, 3.640095956297881*^9}, {3.646236645755533*^9, 
   3.646236647969857*^9}, {3.648640404599332*^9, 3.648640408766715*^9}, {
   3.648640547476536*^9, 3.648640551077092*^9}, {3.648647840728489*^9, 
   3.6486478431925707`*^9}, 3.64866070641335*^9, {3.6486651745190077`*^9, 
   3.648665177235181*^9}, {3.648704637680496*^9, 3.6487046443320923`*^9}, {
   3.64873143079807*^9, 3.648731431165389*^9}, {3.648733306094357*^9, 
   3.6487333114482613`*^9}, {3.671415664714057*^9, 3.6714156657781353`*^9}, {
   3.674925336744913*^9, 3.6749253370023603`*^9}, {3.674932018898439*^9, 
   3.6749320192366962`*^9}, {3.790838789694542*^9, 3.790838792216404*^9}, {
   3.861705597600564*^9, 
   3.861705598132065*^9}},ExpressionUUID->"d6cdec3d-978d-44a9-aaf5-\
5bae775f744a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"perm12", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"{", 
     RowBox[{"q1", ",", "q2"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"perm123", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"{", 
     RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"perm1234", "=", 
   RowBox[{"Permutations", "[", 
    RowBox[{"{", 
     RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.854023436047214*^9, 3.854023438770822*^9}, {
  3.854391304999798*^9, 3.854391306289887*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"a48f6833-0977-4d92-ab3e-7f31de984de8"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", "n"], " ", "and", " ", 
    SubscriptBox["G", "n"], "kernels"}], TraditionalForm]],ExpressionUUID->
  "ea7a1d8c-19a3-4a00-b922-96a5d898a868"]
}], "Subsubsection",
 CellChangeTimes->{{3.853958659798813*^9, 3.853958662475305*^9}, {
  3.853959943612678*^9, 3.853959945432715*^9}, {3.854397392010775*^9, 
  3.8543973984503183`*^9}, {3.8594598283723392`*^9, 
  3.859459829221487*^9}},ExpressionUUID->"39158c7b-6178-4dbd-bd08-\
ccb6115dc873"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "Fn", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fn", "[", 
    RowBox[{"n_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", "1"}], ",", "1", ",", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"Gn", "[", 
          RowBox[{"m", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "m"}], "]"}], "]"}]}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "3"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1"}], ")"}], 
           RowBox[{"al", "[", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "m"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}], "]"}]}], 
            "]"}], 
           RowBox[{"Fn", "[", 
            RowBox[{
             RowBox[{"n", "-", "m"}], ",", 
             RowBox[{"v", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}]}], "]"}]}],
           "+", 
          RowBox[{"2", 
           RowBox[{"be", "[", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "m"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}], "]"}]}], 
            "]"}], 
           RowBox[{"Gn", "[", 
            RowBox[{
             RowBox[{"n", "-", "m"}], ",", 
             RowBox[{"v", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}]}], 
            "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gn", "[", 
    RowBox[{"n_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", "1"}], ",", "1", ",", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"Gn", "[", 
          RowBox[{"m", ",", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "m"}], "]"}], "]"}]}], "]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "+", "3"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}]}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"al", "[", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "m"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}], "]"}]}], 
            "]"}], 
           RowBox[{"Fn", "[", 
            RowBox[{
             RowBox[{"n", "-", "m"}], ",", 
             RowBox[{"v", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}]}], "]"}]}],
           "+", 
          RowBox[{"2", "n", " ", 
           RowBox[{"be", "[", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "m"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"Total", "[", 
              RowBox[{"v", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}], "]"}]}], 
            "]"}], 
           RowBox[{"Gn", "[", 
            RowBox[{
             RowBox[{"n", "-", "m"}], ",", 
             RowBox[{"v", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ";;", "n"}], "]"}], "]"}]}], 
            "]"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F2s", "[", 
    RowBox[{"q1_", ",", "q2_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "perm12", "]"}]}], 
       RowBox[{"Fn", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"perm12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"perm12", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "perm12", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F3s", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "q3_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "perm123", "]"}]}], 
       RowBox[{"Fn", "[", 
        RowBox[{"3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"perm123", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"perm123", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"perm123", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "perm123", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F4s", "[", 
     RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "q4_"}], "]"}], "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "perm1234", "]"}]}], 
       RowBox[{"Fn", "[", 
        RowBox[{"4", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"perm1234", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{"perm1234", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
           RowBox[{"perm1234", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
           RowBox[{"perm1234", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "perm1234", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"alpha", ",", " ", 
    RowBox[{"beta", " ", "kernels"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alfm", "[", 
    RowBox[{"k1_", ",", "k2_"}], "]"}], ":=", 
   RowBox[{"1", "+", 
    RowBox[{
     FractionBox["1", "2"], 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"mag", "[", 
         RowBox[{"k1", "+", "k2"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"mag", "[", "k1", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"mag", "[", "k2", "]"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"mag", "[", "k1", "]"}], "2"]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"befm", "[", 
    RowBox[{"k1_", ",", "k2_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"mag", "[", 
       RowBox[{"k1", "+", "k2"}], "]"}], "2"], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"mag", "[", 
         RowBox[{"k1", "+", "k2"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"mag", "[", "k1", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"mag", "[", "k2", "]"}], "2"]}], ")"}]}], 
    RowBox[{"4", 
     SuperscriptBox[
      RowBox[{"mag", "[", "k1", "]"}], "2"], 
     SuperscriptBox[
      RowBox[{"mag", "[", "k2", "]"}], "2"]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.593470462396783*^9, 3.59347078861695*^9}, {
   3.5934708242888527`*^9, 3.593470842886025*^9}, {3.593470896057762*^9, 
   3.593470916826777*^9}, {3.593470993887148*^9, 3.5934709994304667`*^9}, {
   3.593471032036338*^9, 3.593471116286831*^9}, {3.5934711621018753`*^9, 
   3.5934711628452377`*^9}, {3.593471246333592*^9, 3.593471332397834*^9}, {
   3.6043379341968307`*^9, 3.6043379798036747`*^9}, {3.674926714949478*^9, 
   3.6749267477188168`*^9}, {3.853958425414484*^9, 3.8539584357732553`*^9}, {
   3.853958651507715*^9, 3.853958672080943*^9}, {3.853959849647739*^9, 
   3.853959866339499*^9}, {3.85395994164721*^9, 3.8539599417772093`*^9}, 
   3.854106657263515*^9, {3.85411789102315*^9, 3.8541178918374243`*^9}, {
   3.85412340197071*^9, 3.854123430177248*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"13e1f143-955c-4fa4-b822-b0cf6ec6e9c5"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Z", "n"], TraditionalForm]],ExpressionUUID->
  "f5f48d23-ff69-4fd1-a346-999efd393300"],
 " kernels (",
 StyleBox["i.e. ",
  FontSlant->"Italic"],
 "with bias and RSD) and symmetrize"
}], "Subsubsection",
 CellChangeTimes->{{3.853958673971484*^9, 3.853958684339878*^9}, {
  3.8539588845925007`*^9, 3.8539588860992613`*^9}, {3.854661582941647*^9, 
  3.854661587230382*^9}},ExpressionUUID->"c353478e-954e-4a3b-868c-\
ef7e2ffc8c48"],

Cell[TextData[{
 "Following 1812.03208, we define the bias expansion as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Delta]", "h"], " ", "=", " ", 
    RowBox[{"{", "b1\[Delta]", "}"}]}], TraditionalForm]],ExpressionUUID->
  "4ab16d7b-a62e-4990-acac-43d79c0c857b"],
 " + ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], "b2", " ", 
        SuperscriptBox["\[Delta]", "2"]}], "+", 
       RowBox[{"g2", " ", "G2"}]}], " ", "}"}], " ", "+", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        FractionBox["1", "6"], 
        SuperscriptBox["b3\[Delta]", "3"]}], "+", 
       RowBox[{"g2x", " ", "G2", " ", "\[Delta]"}], "+", 
       RowBox[{"g3", " ", "G3"}], "+", " ", 
       RowBox[{"g21", " ", 
        SubscriptBox["G2", "21"]}]}], "}"}], "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "4"], "b4", " ", 
          SuperscriptBox["\[Delta]", "4"]}], "+", 
         RowBox[{"g2xx", " ", 
          SuperscriptBox["G2\[Delta]", "2"]}], "+", " ", 
         RowBox[{"g3x", " ", "G3", " ", "\[Delta]"}], "+", 
         RowBox[{"g2sq", " ", 
          SuperscriptBox["G2", "2"]}]}], "]"}], "+", " ", 
       RowBox[{"g21x", " ", "\[Delta]", " ", 
        SubscriptBox["G2", "21"]}], "+", 
       RowBox[{"g211", " ", 
        SubscriptBox["G3", "211"]}], "+", 
       RowBox[{"g22", " ", 
        SubscriptBox["G2", "22"]}], "+", 
       RowBox[{"g31", " ", 
        SubscriptBox["G2", "31"]}]}], "}"}], "+"}], "..."}], 
   TraditionalForm]],ExpressionUUID->"52fd262a-ee9f-475e-8a6d-09ec7d04e8fc"],
 ", separating out the different orders by curly brackets and noting that the \
terms in square brackets do not contribute to the one-loop bispectrum. [For \
convenience gn \[Equivalent] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", "n"], TraditionalForm]],ExpressionUUID->
  "56361b1c-c77d-4db4-a70b-f0510f1116fe"],
 "here, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["G2", "xy"], TraditionalForm]],ExpressionUUID->
  "71dbc390-70d3-4dc3-ab1a-27129b175de0"],
 "\[Equivalent] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "2"], "(", 
    RowBox[{
     SubscriptBox["\[Phi]", "x"], ",", 
     SubscriptBox["\[Phi]", "y"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "61ab24b1-aee2-41f7-8912-53850f3285c0"],
 "]. The third-order biases contributing to the power spectrum are related to \
our notation via ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g2", " ", "\[TwoWayRule]", " ", 
    SubscriptBox["b", "G2"]}], TraditionalForm]],ExpressionUUID->
  "6ecf3f06-6836-4c15-9df5-f88c2097a1a2"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g21", "\[TwoWayRule]", " ", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"4", " "}], "7"]}], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["b", "\[CapitalGamma]3"], "+", 
       SubscriptBox["b", "G2"]}], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "de02606c-858e-4a5f-b9c2-7dd1309b0a6d"],
 "."
}], "Text",
 CellChangeTimes->{{3.854469551726605*^9, 3.85446966299601*^9}, {
   3.854469702822711*^9, 3.854469704566032*^9}, {3.854471581333873*^9, 
   3.854471756797719*^9}, {3.8544732233762417`*^9, 3.854473235161806*^9}, {
   3.854473274482246*^9, 3.854473569178854*^9}, {3.854473605259308*^9, 
   3.854473816651157*^9}, {3.85447472983505*^9, 3.8544747298353786`*^9}, 
   3.8544763126425867`*^9, {3.854489716119275*^9, 3.85448975086201*^9}, {
   3.854544574885476*^9, 3.854544574885683*^9}, {3.855670066960733*^9, 
   3.855670066960905*^9}},ExpressionUUID->"b0529966-e19b-4965-9033-\
f4a380ffc2d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "b1", ",", "b2", ",", "g2", ",", "b3", ",", "g2x", ",", "g3", ",", "g21", 
    ",", "g21x", ",", " ", "g211", ",", "g22", ",", " ", "g31", ",", "betaBa",
     ",", "betaBb", ",", "betaBb", ",", "betaBc", ",", "betaBd", ",", 
    "betaBe", ",", "eps0", ",", "eta0", ",", "eps2", ",", "eta21", ",", 
    "eta22", ",", "f", ",", "k1", ",", "k2", ",", "k3"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.853961491951542*^9, 3.853961499125317*^9}, {
   3.8539671117186823`*^9, 3.853967112242968*^9}, {3.854025486159552*^9, 
   3.85402559257145*^9}, 3.854026249894642*^9, {3.8540281592794743`*^9, 
   3.854028165101083*^9}, {3.8540285735831003`*^9, 3.8540285736605463`*^9}, 
   3.854028635478257*^9, {3.8540291837067747`*^9, 3.854029193657427*^9}, {
   3.854029294822863*^9, 3.85402929675427*^9}, {3.854029477774322*^9, 
   3.8540294794519444`*^9}, {3.854056544880319*^9, 3.8540565581357813`*^9}, {
   3.8542856559497147`*^9, 3.854285675992989*^9}, {3.854308860840087*^9, 
   3.8543088634386797`*^9}, {3.854309043135049*^9, 3.854309049574113*^9}, {
   3.854309225364512*^9, 3.854309227182425*^9}, {3.8543092646586514`*^9, 
   3.854309269432652*^9}, {3.854309368139258*^9, 3.854309370503399*^9}, {
   3.854309484902417*^9, 3.854309487423345*^9}, {3.854309948189939*^9, 
   3.854309950705277*^9}, {3.854310569117051*^9, 3.854310573482346*^9}, 
   3.8543108379412823`*^9, {3.8544549396650467`*^9, 3.854454941291388*^9}, {
   3.854455020284358*^9, 3.85445502220518*^9}, {3.8544738063720016`*^9, 
   3.8544739312069683`*^9}, {3.854476299566903*^9, 3.8544763181806717`*^9}, {
   3.854489689936879*^9, 3.854489710382691*^9}, {3.8544906751425133`*^9, 
   3.854490682083892*^9}, 3.854490848077395*^9, 3.854570966682703*^9, {
   3.854661655745694*^9, 3.8546616566771393`*^9}, {3.855069078875658*^9, 
   3.855069079691345*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"0b4720e3-ba25-4320-b918-84287f55a45a"],

Cell["Angular Operators", "Text",
 CellChangeTimes->{{3.854474349868875*^9, 3.854474353053176*^9}, 
   3.8556977194836893`*^9},ExpressionUUID->"44946857-4fa0-4b68-b2cf-\
f7efd3a3029e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ang", "[", 
    RowBox[{"qa_", ",", "qb_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"mag", "[", 
       RowBox[{"qa", "+", "qb"}], "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"mag", "[", "qa", "]"}], "2"], "-", 
     SuperscriptBox[
      RowBox[{"mag", "[", "qb", "]"}], "2"]}], 
    RowBox[{"2", 
     RowBox[{"mag", "[", "qa", "]"}], 
     RowBox[{"mag", "[", "qb", "]"}]}]]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"angle", " ", "between", " ", "qa", " ", "and", " ", "qb"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angK", "[", 
    RowBox[{"qa_", ",", "qb_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"ang", "[", 
      RowBox[{"qa", ",", "qb"}], "]"}], "2"], "-", "1"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"K", " ", "kernel", " ", "appearing", " ", "in", " ", "G2"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"NB", ":", " ", 
     RowBox[{
     "ang1", " ", "will", " ", "be", " ", "replaced", " ", "by", " ", "ang", 
      " ", "later"}]}], ",", " ", 
    RowBox[{
    "it", " ", "just", " ", "allows", " ", "removal", " ", "of", " ", "some", 
     " ", "nasty", " ", "terms"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angK1", "[", 
    RowBox[{"qa_", ",", "qb_"}], "]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"ang1", "[", 
      RowBox[{"qa", ",", "qb"}], "]"}], "2"], "-", "1"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"K", " ", "kernel", " ", "appearing", " ", "in", " ", "G2"}], ",",
     " ", "unevaluated"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angL", "[", 
    RowBox[{"qa_", ",", "qb_", ",", "qc_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"ang1", "[", 
      RowBox[{"qa", ",", "qb"}], "]"}], 
     RowBox[{"ang1", "[", 
      RowBox[{"qb", ",", "qc"}], "]"}], 
     RowBox[{"ang1", "[", 
      RowBox[{"qc", ",", "qa"}], "]"}]}], "-", 
    SuperscriptBox[
     RowBox[{"ang1", "[", 
      RowBox[{"qa", ",", "qb"}], "]"}], "2"], "-", 
    SuperscriptBox[
     RowBox[{"ang1", "[", 
      RowBox[{"qb", ",", "qc"}], "]"}], "2"], "-", 
    SuperscriptBox[
     RowBox[{"ang1", "[", 
      RowBox[{"qc", ",", "qa"}], "]"}], "2"], "+", "1"}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"L", " ", "kernel", " ", "appearing", " ", "in", " ", "G3"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angM", "[", 
   RowBox[{"qa_", ",", "qb_", ",", "qc_", ",", "qd_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ang1", "[", 
    RowBox[{"qa", ",", "qb"}], "]"}], 
   RowBox[{"ang1", "[", 
    RowBox[{"qb", ",", "qc"}], "]"}], 
   RowBox[{"ang1", "[", 
    RowBox[{"qc", ",", "qd"}], "]"}], 
   RowBox[{"ang1", "[", 
    RowBox[{"qd", ",", "qa"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"M", " ", "kernel", " ", "appearing", " ", "in", " ", 
     SubscriptBox["G2", "31"]}], " ", "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.854474357075128*^9, 3.854474403736759*^9}, {
  3.854474440212666*^9, 3.854474457367031*^9}, {3.8544753544651623`*^9, 
  3.854475400381508*^9}, {3.854479564897913*^9, 3.8544795703828917`*^9}, {
  3.854484798309205*^9, 3.8544848419699907`*^9}, {3.8556704003561563`*^9, 
  3.855670430078479*^9}, {3.857545177648555*^9, 3.8575451797545137`*^9}, {
  3.8595767197343397`*^9, 3.859576732905802*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"9bcc5142-71b7-4f64-b11d-8da8dd6e3a72"],

Cell["O(1) kernel", "Text",
 CellChangeTimes->{{3.854025600292892*^9, 
  3.854025601665069*^9}},ExpressionUUID->"9f694f9c-3c9d-409f-8b6c-\
7477eb0022ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"K1", "=", "b1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z1s", "[", "q1_", "]"}], ":=", 
   RowBox[{"K1", "+", " ", 
    RowBox[{"f", " ", 
     SuperscriptBox[
      RowBox[{"\[Eta]", "[", "q1", "]"}], "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{3.854025602759653*^9, 3.854661667770855*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"6d7210e6-2f2c-4a3c-8574-183cacff172b"],

Cell["O(2) kernel", "Text",
 CellChangeTimes->{{3.854025604148911*^9, 3.854025605677328*^9}, 
   3.854095131581161*^9, 
   3.854106669460793*^9},ExpressionUUID->"5555aa88-ec22-426f-a2f0-\
919e04449f52"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"K2", "[", 
   RowBox[{"q1_", ",", "q2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["b2", "2"], "+", 
     RowBox[{"g2", " ", 
      RowBox[{"angK", "[", 
       RowBox[{"q1", ",", "q2"}], "]"}]}]}], ")"}], "+", 
   RowBox[{"b1", " ", 
    RowBox[{"Fn", "[", 
     RowBox[{"2", ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z2", "[", 
   RowBox[{"q1_", ",", "q2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"K2", "[", 
      RowBox[{"q1", ",", "q2"}], "]"}], "+", " ", 
     RowBox[{"f", " ", 
      SuperscriptBox[
       RowBox[{"\[Eta]", "[", 
        RowBox[{"q1", "+", "q2"}], "]"}], "2"], 
      RowBox[{"Gn", "[", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"f", " ", 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"q1", "+", "q2"}], "]"}], 
       RowBox[{"mag", "[", 
        RowBox[{"q1", "+", "q2"}], "]"}]}], "2"], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Eta]", "[", "q1", "]"}], 
        RowBox[{"mag", "[", "q1", "]"}]], "+", 
       FractionBox[
        RowBox[{"\[Eta]", "[", "q2", "]"}], 
        RowBox[{"mag", "[", "q2", "]"}]]}], ")"}], "K1"}], ")"}], "+", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"f", " ", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], 
        RowBox[{"mag", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}]}], ")"}], "2"], "2"], 
    FractionBox[
     RowBox[{"\[Eta]", "[", "q1", "]"}], 
     RowBox[{"mag", "[", "q1", "]"}]], 
    FractionBox[
     RowBox[{"\[Eta]", "[", "q2", "]"}], 
     RowBox[{"mag", "[", "q2", "]"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z2s", "[", 
    RowBox[{"q1_", ",", "q2_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "perm12", "]"}]}], 
       RowBox[{"Z2", "[", 
        RowBox[{
         RowBox[{"perm12", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"perm12", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "perm12", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.853958685937563*^9, 3.8539587018155518`*^9}, {
   3.853958739626742*^9, 3.853958796244813*^9}, {3.853958843471716*^9, 
   3.8539589455524893`*^9}, {3.85395987821705*^9, 3.853959898716765*^9}, {
   3.853960045112623*^9, 3.853960100869775*^9}, {3.853960204791583*^9, 
   3.853960225648531*^9}, {3.853960332369548*^9, 3.8539604039296217`*^9}, {
   3.853960444131822*^9, 3.8539604802602043`*^9}, {3.85396051533709*^9, 
   3.8539606523330507`*^9}, {3.8539607061246233`*^9, 3.853960729023407*^9}, {
   3.853960859712297*^9, 3.853960862813881*^9}, {3.853960946903865*^9, 
   3.8539609471041307`*^9}, {3.853961148676837*^9, 3.853961171813599*^9}, {
   3.853961458179696*^9, 3.853961473882937*^9}, {3.853961634323083*^9, 
   3.8539616382498302`*^9}, {3.853968375234303*^9, 3.853968379284876*^9}, {
   3.853968410097703*^9, 3.853968416013193*^9}, {3.8539685090130787`*^9, 
   3.8539685185389557`*^9}, {3.853968605468988*^9, 3.853968606394352*^9}, {
   3.853969078711038*^9, 3.85396911118332*^9}, {3.853969314738347*^9, 
   3.8539694613285427`*^9}, {3.853969517396698*^9, 3.853969544577174*^9}, {
   3.854025122389916*^9, 3.854025124554022*^9}, {3.854025389507937*^9, 
   3.854025426127543*^9}, {3.854025597963385*^9, 3.854025680988473*^9}, 
   3.854026254835374*^9, 3.854469697717795*^9, {3.854474189037751*^9, 
   3.854474212844795*^9}, {3.8544742562131577`*^9, 3.854474265455729*^9}, {
   3.854474347778871*^9, 3.854474355266157*^9}, 3.8546616734790363`*^9, {
   3.855074657830654*^9, 3.855074703301272*^9}, {3.857546097073166*^9, 
   3.857546119367697*^9}, {3.857546309475032*^9, 3.857546317682351*^9}, {
   3.8582441876182528`*^9, 3.858244189924614*^9}, {3.8583563576615267`*^9, 
   3.8583563591401377`*^9}, {3.858411050421288*^9, 3.858411051652689*^9}, {
   3.85957672905746*^9, 3.8595767307704906`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"01265db1-8372-49ab-b587-67d8550450e7"],

Cell["O(3) operators and kernel", "Text",
 CellChangeTimes->{{3.854025617455098*^9, 3.8540256207737827`*^9}, {
  3.854474691793898*^9, 
  3.854474692918292*^9}},ExpressionUUID->"c576a84e-16fe-4136-bf66-\
625bacbe80da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"K3", "[", 
   RowBox[{"q1_", ",", "q2_", ",", "q3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"b3", " "}], "6"], "+", 
     RowBox[{"g2x", " ", 
      RowBox[{"angK", "[", 
       RowBox[{"q1", ",", "q2"}], "]"}]}], "+", 
     RowBox[{"g3", " ", 
      RowBox[{"angL", "[", 
       RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}]}], "+", 
     RowBox[{"g21", " ", 
      RowBox[{"angK", "[", 
       RowBox[{"q1", ",", 
        RowBox[{"q2", "+", "q3"}]}], "]"}], 
      RowBox[{"angK", "[", 
       RowBox[{"q2", ",", "q3"}], "]"}]}]}], " ", ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"b2", " ", 
      RowBox[{"Fn", "[", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"2", "g2", " ", 
      RowBox[{"angK", "[", 
       RowBox[{"q1", ",", 
        RowBox[{"q2", "+", "q3"}]}], "]"}], 
      RowBox[{"Gn", "[", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"q2", ",", "q3"}], "}"}]}], "]"}]}]}], " ", ")"}], " ", "+", 
   " ", 
   RowBox[{"(", 
    RowBox[{"b1", " ", 
     RowBox[{"Fn", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z3", "[", 
   RowBox[{"q1_", ",", "q2_", ",", "q3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"K3", "[", 
    RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}], "+", 
   RowBox[{"f", " ", 
    SuperscriptBox[
     RowBox[{"\[Eta]", "[", 
      RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}], "2"], 
    RowBox[{"Gn", "[", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"f", " ", 
      RowBox[{"mag", "[", 
       RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}], " ", 
      RowBox[{"\[Eta]", "[", 
       RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[Eta]", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], 
        RowBox[{"mag", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}]], 
       RowBox[{"Gn", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Eta]", "[", "q3", "]"}], 
        RowBox[{"mag", "[", "q3", "]"}]], 
       RowBox[{"K2", "[", 
        RowBox[{"q1", ",", "q2"}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"f", " ", 
        RowBox[{"mag", "[", 
         RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}], " ", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}]}], ")"}], "2"], "2"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       FractionBox[
        RowBox[{"\[Eta]", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}], 
        RowBox[{"mag", "[", 
         RowBox[{"q1", "+", "q2"}], "]"}]], 
       FractionBox[
        RowBox[{"\[Eta]", "[", "q3", "]"}], 
        RowBox[{"mag", "[", "q3", "]"}]], 
       RowBox[{"Gn", "[", 
        RowBox[{"2", ",", 
         RowBox[{"{", 
          RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Eta]", "[", "q1", "]"}], 
        RowBox[{"mag", "[", "q1", "]"}]], 
       FractionBox[
        RowBox[{"\[Eta]", "[", "q2", "]"}], 
        RowBox[{"mag", "[", "q2", "]"}]], "K1"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"f", " ", 
        RowBox[{"mag", "[", 
         RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}], " ", 
        RowBox[{"\[Eta]", "[", 
         RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}]}], ")"}], "3"], "6"], 
    FractionBox[
     RowBox[{"\[Eta]", "[", "q1", "]"}], 
     RowBox[{"mag", "[", "q1", "]"}]], 
    FractionBox[
     RowBox[{"\[Eta]", "[", "q2", "]"}], 
     RowBox[{"mag", "[", "q2", "]"}]], 
    FractionBox[
     RowBox[{"\[Eta]", "[", "q3", "]"}], 
     RowBox[{"mag", "[", "q3", "]"}]]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z3s", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "q3_"}], "]"}], "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Length", "[", "perm123", "]"}]}], 
       RowBox[{"Z3", "[", 
        RowBox[{
         RowBox[{"perm123", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"perm123", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"perm123", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "perm123", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.854025623547957*^9, {3.8540256884504223`*^9, 3.8540257010522413`*^9}, {
   3.854455229706818*^9, 3.854455247389554*^9}, {3.8544697598817787`*^9, 
   3.854469850016691*^9}, {3.854474289863435*^9, 3.854474307124072*^9}, {
   3.8544743399907303`*^9, 3.854474342637795*^9}, {3.854474416466579*^9, 
   3.854474443252948*^9}, {3.854474496932577*^9, 3.854474545713037*^9}, {
   3.854474608083197*^9, 3.854474653932168*^9}, 3.8546616806078587`*^9, 
   3.8595767479082127`*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"03d0fa56-0de3-4dcf-ad24-e6dec241274f"],

Cell[TextData[{
 "O(4) kernel. Note that we include only terms which contribute to the 1-loop \
bispectrum. This drops terms such as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Delta]", "3"], TraditionalForm]],ExpressionUUID->
  "9c85480e-1944-4286-9157-00aee2315b3b"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Delta]", "4"], TraditionalForm]],ExpressionUUID->
  "95fb0b83-e078-4b2c-82ff-544eea660c9a"],
 " which are renormalized away in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "411"], TraditionalForm]],ExpressionUUID->
  "1ed34dc4-2ffa-4338-9ba2-84eddbc699f6"],
 "(but not at higher-loop order). In general, all operators should be \
renormalized: this has the effect of removing tadpole contributions in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "13"], TraditionalForm]],ExpressionUUID->
  "4897ae23-35bc-48f5-b1ad-cb343d5fd4cb"],
 "(part of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", 
    RowBox[{"321", "-", "II"}]], TraditionalForm]],ExpressionUUID->
  "58eb9426-9333-4535-8fa0-a9d2c0bc35f7"],
 ") from ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g2x", ",", " ", 
    RowBox[{"g3", " ", "and", " ", "b3"}]}], TraditionalForm]],ExpressionUUID->
  "71fc0a1c-ba87-4789-9bd8-cb27e029617d"],
 ", and removing the UV limits proportional to ",
 Cell[BoxData[
  FormBox[
   RowBox[{"b3", ",", " ", "g21x", ",", " ", "g2x", ",", " ", 
    RowBox[{"and", " ", "b2"}]}], TraditionalForm]],ExpressionUUID->
  "7f0dbcbd-5955-4387-ba71-30f7ecc4d68b"],
 ". This removes the entire b3 term, so we drop it from the kernels below. "
}], "Text",
 CellChangeTimes->{{3.854025454579917*^9, 3.854025456325548*^9}, {
   3.8540258594813337`*^9, 3.854025860872892*^9}, 3.854476163290501*^9, {
   3.8546151996965027`*^9, 
   3.854615296397272*^9}},ExpressionUUID->"e1997c2c-6a06-4fa8-8c9c-\
1ca10ac8fcc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"K4", "[", 
   RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "q4_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g21x", " ", 
      RowBox[{"angK1", "[", 
       RowBox[{"q1", ",", 
        RowBox[{"q2", "+", "q3"}]}], "]"}], 
      RowBox[{"angK1", "[", 
       RowBox[{"q2", ",", "q3"}], "]"}]}], "+", 
     RowBox[{"g211", " ", 
      RowBox[{"angL", "[", 
       RowBox[{"q1", ",", "q2", ",", 
        RowBox[{"q3", "+", "q4"}]}], "]"}], 
      RowBox[{"angK1", "[", 
       RowBox[{"q3", ",", "q4"}], "]"}]}], "+", 
     RowBox[{"g22", " ", 
      RowBox[{"angK1", "[", 
       RowBox[{
        RowBox[{"q1", "+", "q2"}], ",", 
        RowBox[{"q3", "+", "q4"}]}], "]"}], 
      RowBox[{"angK1", "[", 
       RowBox[{"q1", ",", "q2"}], "]"}], 
      RowBox[{"angK1", "[", 
       RowBox[{"q3", ",", "q4"}], "]"}]}], "+", 
     RowBox[{"g31", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "18"], 
         RowBox[{"angK1", "[", 
          RowBox[{"q1", ",", 
           RowBox[{"q2", "+", "q3", "+", "q4"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox["15", "7"], 
            RowBox[{"angK1", "[", 
             RowBox[{
              RowBox[{"q2", "+", "q3"}], ",", "q4"}], "]"}], 
            RowBox[{"angK1", "[", 
             RowBox[{"q2", ",", "q3"}], "]"}]}], "-", 
           RowBox[{"angL", "[", 
            RowBox[{"q2", ",", "q3", ",", "q4"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "14"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"angM", "[", 
            RowBox[{"q1", ",", 
             RowBox[{"q2", "+", "q3"}], ",", "q4", ",", 
             RowBox[{"q2", "+", "q3", "+", "q4"}]}], "]"}], "-", 
           RowBox[{"angM", "[", 
            RowBox[{"q1", ",", 
             RowBox[{"q2", "+", "q3", "+", "q4"}], ",", 
             RowBox[{"q2", "+", "q3"}], ",", "q4"}], "]"}]}], ")"}], 
         RowBox[{"angK1", "[", 
          RowBox[{"q2", ",", "q3"}], "]"}]}]}], ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"0", 
      FractionBox["1", "2"], "b3", " ", 
      RowBox[{"Fn", "[", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"g2x", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"angK1", "[", 
          RowBox[{
           RowBox[{"q1", "+", "q2"}], ",", "q3"}], "]"}], 
         RowBox[{"Gn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"angK1", "[", 
          RowBox[{"q3", ",", "q4"}], "]"}], 
         RowBox[{"Fn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"g21", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"angK1", "[", 
          RowBox[{
           RowBox[{"q1", "+", "q2"}], ",", 
           RowBox[{"q3", "+", "q4"}]}], "]"}], 
         RowBox[{"angK1", "[", 
          RowBox[{"q1", ",", "q2"}], "]"}], 
         RowBox[{"Fn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q3", ",", "q4"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"angK1", "[", 
          RowBox[{
           RowBox[{"q1", "+", "q2", "+", "q3"}], ",", "q4"}], "]"}], 
         RowBox[{"angK1", "[", 
          RowBox[{
           RowBox[{"q1", "+", "q2"}], ",", "q3"}], "]"}], 
         RowBox[{"Fn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"3", "g3", " ", 
      RowBox[{"angL", "[", 
       RowBox[{"q1", ",", "q2", ",", 
        RowBox[{"q3", "+", "q4"}]}], "]"}], 
      RowBox[{"Gn", "[", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"q3", ",", "q4"}], "}"}]}], "]"}]}]}], " ", ")"}], "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], "b2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Fn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}], 
         RowBox[{"Fn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q3", ",", "q4"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"Fn", "[", 
          RowBox[{"3", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], "]"}]}]}], ")"}]}],
      "+", " ", 
     RowBox[{"g2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"angK1", "[", 
          RowBox[{
           RowBox[{"q1", "+", "q2"}], ",", 
           RowBox[{"q3", "+", "q4"}]}], "]"}], 
         RowBox[{"Gn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}], 
         RowBox[{"Gn", "[", 
          RowBox[{"2", ",", 
           RowBox[{"{", 
            RowBox[{"q3", ",", "q4"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"angK1", "[", 
          RowBox[{
           RowBox[{"q1", "+", "q2", "+", "q3"}], ",", "q4"}], "]"}], 
         RowBox[{"Gn", "[", 
          RowBox[{"3", ",", 
           RowBox[{"{", 
            RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], "]"}]}]}], 
       ")"}]}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"b1", " ", 
     RowBox[{"Fn", "[", 
      RowBox[{"4", ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}]}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z4", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "q4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"K4", "[", 
     RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "]"}], "+", 
    RowBox[{"f", " ", 
     SuperscriptBox[
      RowBox[{"\[Eta]", "[", 
       RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}], "2"], 
     RowBox[{"Gn", "[", 
      RowBox[{"4", ",", 
       RowBox[{"{", 
        RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "}"}]}], "]"}]}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", " ", 
       RowBox[{"mag", "[", 
        RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}], 
       RowBox[{"\[Eta]", "[", 
        RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}]], "K1", " ", 
        RowBox[{"Gn", "[", 
         RowBox[{"3", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Eta]", "[", "q4", "]"}], 
         RowBox[{"mag", "[", "q4", "]"}]], 
        RowBox[{"K3", "[", 
         RowBox[{"q1", ",", "q2", ",", "q3"}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}]], 
        RowBox[{"Gn", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}], 
        RowBox[{"K2", "[", 
         RowBox[{"q3", ",", "q4"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", " ", 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}], 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}]}], ")"}], 
       "2"], "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3"}], "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q4", "]"}], 
         RowBox[{"mag", "[", "q4", "]"}]], 
        RowBox[{"Gn", "[", 
         RowBox[{"3", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2", ",", "q3"}], "}"}]}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q3", "+", "q4"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q3", "+", "q4"}], "]"}]], 
        RowBox[{"Gn", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}], 
        RowBox[{"Gn", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"q3", ",", "q4"}], "}"}]}], "]"}]}], "+", 
       RowBox[{"2", 
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q3", "]"}], 
         RowBox[{"mag", "[", "q3", "]"}]], "K1", " ", 
        RowBox[{"Gn", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Eta]", "[", "q1", "]"}], 
         RowBox[{"mag", "[", "q1", "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q2", "]"}], 
         RowBox[{"mag", "[", "q2", "]"}]], 
        RowBox[{"K2", "[", 
         RowBox[{"q3", ",", "q4"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", " ", 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}], 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}]}], ")"}], 
       "3"], "6"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        FractionBox[
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}], 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2"}], "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q3", "]"}], 
         RowBox[{"mag", "[", "q3", "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q4", "]"}], 
         RowBox[{"mag", "[", "q4", "]"}]], 
        RowBox[{"Gn", "[", 
         RowBox[{"2", ",", 
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2"}], "}"}]}], "]"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Eta]", "[", "q1", "]"}], 
         RowBox[{"mag", "[", "q1", "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q2", "]"}], 
         RowBox[{"mag", "[", "q2", "]"}]], 
        FractionBox[
         RowBox[{"\[Eta]", "[", "q3", "]"}], 
         RowBox[{"mag", "[", "q3", "]"}]], "K1"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"f", " ", 
         RowBox[{"mag", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}], 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"q1", "+", "q2", "+", "q3", "+", "q4"}], "]"}]}], ")"}], 
       "4"], "24"], 
     FractionBox[
      RowBox[{"\[Eta]", "[", "q1", "]"}], 
      RowBox[{"mag", "[", "q1", "]"}]], 
     FractionBox[
      RowBox[{"\[Eta]", "[", "q2", "]"}], 
      RowBox[{"mag", "[", "q2", "]"}]], 
     FractionBox[
      RowBox[{"\[Eta]", "[", "q3", "]"}], 
      RowBox[{"mag", "[", "q3", "]"}]], 
     FractionBox[
      RowBox[{"\[Eta]", "[", "q4", "]"}], 
      RowBox[{"mag", "[", "q4", "]"}]]}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NB", ":", " ", 
    RowBox[{"avoid", " ", "simplifying", " ", "this", " ", "long", " ", 
     RowBox[{"expression", "!"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z4s", "[", 
    RowBox[{"q1_", ",", "q2_", ",", "q3_", ",", "q4_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Length", "[", "perm1234", "]"}]}], 
      RowBox[{"Z4", "[", 
       RowBox[{
        RowBox[{"perm1234", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"perm1234", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"perm1234", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"perm1234", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "perm1234", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.854474742391055*^9, 3.854474772241233*^9}, {
   3.854474804341672*^9, 3.854474885856954*^9}, {3.8544749171837053`*^9, 
   3.85447495591897*^9}, {3.85447499238625*^9, 3.854475084223518*^9}, {
   3.854475150542306*^9, 3.854475185941538*^9}, {3.854475235389071*^9, 
   3.854475274397357*^9}, {3.854475319787429*^9, 3.854475348452653*^9}, 
   3.85447540641507*^9, {3.854475452432016*^9, 3.8544754567697277`*^9}, {
   3.854475539848715*^9, 3.854475623296838*^9}, {3.854475760874856*^9, 
   3.854475930248942*^9}, {3.8544759641403418`*^9, 3.854475983811685*^9}, {
   3.854476049017815*^9, 3.854476141231254*^9}, {3.8544761930324297`*^9, 
   3.8544761931055098`*^9}, {3.854476335178125*^9, 3.85447637514587*^9}, {
   3.854476829747426*^9, 3.854476835949325*^9}, {3.854476959416239*^9, 
   3.854476966267857*^9}, {3.85447952716289*^9, 3.85447953031024*^9}, {
   3.854479574096695*^9, 3.854479602341034*^9}, 3.854661691910109*^9, 
   3.8556714262064037`*^9, {3.855671504006589*^9, 3.855671504104192*^9}, 
   3.859576762087899*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"b91cdb17-768a-411c-a63d-d8a771c8d0c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Define RSD angular substitutions", "Subsubsection",
 CellChangeTimes->{{3.8547071828916683`*^9, 
  3.854707189362048*^9}},ExpressionUUID->"d82815db-1444-4c1c-b3cb-\
ec5fbb908aa5"],

Cell[TextData[{
 "Here, we load in precomputed isotropic tensors formed from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1b2ffd3c-a920-42cc-86fe-1243ef9fbb9b"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Delta]", "K"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "2adbcf40-f56e-4497-80ac-0232e23f2bd6"],
 ". This decomposition differs from the full (non-flat) case."
}], "Text",
 CellChangeTimes->{{3.8617053175376797`*^9, 3.861705354356366*^9}, {
  3.861713926358478*^9, 
  3.8617139534021683`*^9}},ExpressionUUID->"4b98a41e-be79-4e5d-ba2d-\
c38ff880904f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"muTable", "=", 
   RowBox[{"Import", "[", "\"\<muTensorsFlat_n6.wdx\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muSubs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"n", "=", "6"}], ",", 
    RowBox[{"n", "\[GreaterEqual]", "1"}], ",", 
    RowBox[{"n", "--"}], ",", "\[IndentingNewLine]", 
    RowBox[{"muSubs", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"muSubs", ",", 
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"\[Eta]", "[", "q", "]"}], "n"], "\[Rule]", " ", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"ang1", "[", 
              RowBox[{"k1", ",", "q"}], "]"}], "i1"], 
            RowBox[{"muTable", "[", 
             RowBox[{"[", 
              RowBox[{"n", ",", 
               RowBox[{"i1", "+", "1"}]}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "0", ",", "n"}], "}"}]}], "]"}]}], "}"}]}], 
      "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muSubsExt", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Eta]", "[", "k1", "]"}], "\[Rule]", "\[Mu]1"}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", "k2", "]"}], "\[Rule]", "\[Mu]2"}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", "k3", "]"}], "\[Rule]", "\[Mu]3"}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{
        RowBox[{"-", "k1"}], "-", "k2"}], "]"}], "\[Rule]", "\[Mu]3"}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k1", "+", "k2"}], "]"}], "\[Rule]", 
      RowBox[{"-", "\[Mu]3"}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k2", "+", "k3"}], "]"}], "\[Rule]", 
      RowBox[{"-", "\[Mu]1"}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k1", "+", "k3"}], "]"}], "\[Rule]", 
      RowBox[{"-", "\[Mu]2"}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k1", "-", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        FractionBox["k1", "k1mq"], "\[Mu]1"}], "-", 
       RowBox[{
        FractionBox["q", "k1mq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k1", "+", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        FractionBox["k1", "k1pq"], "\[Mu]1"}], "+", 
       RowBox[{
        FractionBox["q", "k1pq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{
        RowBox[{"-", "k1"}], "-", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["k1", "k1pq"]}], "\[Mu]1"}], "-", 
       RowBox[{
        FractionBox["q", "k1pq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k2", "-", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        FractionBox["k2", "k2mq"], "\[Mu]2"}], "-", 
       RowBox[{
        FractionBox["q", "k2mq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{
        RowBox[{"-", "k2"}], "+", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         FractionBox["k2", "k2mq"]}], "\[Mu]2"}], "+", 
       RowBox[{
        FractionBox["q", "k2mq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k2", "+", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        FractionBox["k2", "k2pq"], "\[Mu]2"}], "+", 
       RowBox[{
        FractionBox["q", "k2pq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k3", "-", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        FractionBox["k3", "k3mq"], "\[Mu]3"}], "-", 
       RowBox[{
        FractionBox["q", "k3mq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k3", "+", "q"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        FractionBox["k3", "k3pq"], "\[Mu]3"}], "+", 
       RowBox[{
        FractionBox["q", "k3pq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{
        RowBox[{"-", "k1"}], "-", "k2", "+", "q"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{
        FractionBox["k3", "k3pq"], "\[Mu]3"}], "+", 
       RowBox[{
        FractionBox["q", "k3pq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k1", "+", "k2", "+", "q"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", 
         FractionBox["k3", "k3mq"]}], "\[Mu]3"}], "+", 
       RowBox[{
        FractionBox["q", "k3mq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"k1", "+", "k2", "-", "q"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", 
         FractionBox["k3", "k3pq"]}], "\[Mu]3"}], "-", 
       RowBox[{
        FractionBox["q", "k3pq"], 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8550685401818123`*^9, 3.8550687168327093`*^9}, {
   3.8550688106463003`*^9, 3.855068938370647*^9}, {3.855069012360489*^9, 
   3.85506901241129*^9}, {3.855069195357766*^9, 3.85506926849119*^9}, {
   3.855069409807341*^9, 3.855069423511592*^9}, {3.855071465895458*^9, 
   3.8550715322254343`*^9}, {3.85508969629151*^9, 3.8550897033307123`*^9}, 
   3.855089877597754*^9, {3.855135350684783*^9, 3.855135371511815*^9}, {
   3.855135426742646*^9, 3.855135458622102*^9}, {3.8551356310912733`*^9, 
   3.8551356336509657`*^9}, {3.855679848115405*^9, 3.855679848690096*^9}, {
   3.858411945716742*^9, 3.858411979967639*^9}, {3.859276903568817*^9, 
   3.8592769106663027`*^9}, 3.85927713677433*^9, {3.859624303403211*^9, 
   3.859624303576932*^9}, {3.859884010700923*^9, 3.859884030236785*^9}, {
   3.859884132011578*^9, 3.859884147477213*^9}, {3.85988424885631*^9, 
   3.859884249382207*^9}, 3.85988431090587*^9, {3.861713788834572*^9, 
   3.8617137955244837`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"39a62a43-1edc-4d5a-93c0-f6de0aaa34fa"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["FFTLog Kernels", "Section",
 CellChangeTimes->{{3.861713539046954*^9, 
  3.861713548765889*^9}},ExpressionUUID->"028af50f-adbd-4fea-adb7-\
2d96df6d4c6e"],

Cell["\<\
Below, we compute the kernels used to compute the one-loop bispectrum \
tempaltes.\
\>", "Text",
 CellChangeTimes->{{3.861713586253861*^9, 
  3.8617136071406307`*^9}},ExpressionUUID->"1c2478c6-661c-4c8d-a615-\
97d1ec8d0880"],

Cell[CellGroupData[{

Cell["B211 Kernel ", "Subsection",
 CellChangeTimes->{{3.854098334354145*^9, 3.854098335512136*^9}, {
   3.8544850649002934`*^9, 3.8544850658509274`*^9}, 
   3.855069965633664*^9},ExpressionUUID->"ae200576-0016-4450-9e5a-\
5a2369e59aa2"],

Cell[TextData[{
 "This computes the analytic ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "211"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f039996e-dbb8-4437-a6de-f52ac30f17f9"],
 " tree-level bispectrum. This function is not used in this notebook; it \
appears for illustration only."
}], "Text",
 CellChangeTimes->{{3.861705389539764*^9, 
  3.861705432197894*^9}},ExpressionUUID->"ad1ddfa8-d8d3-4a62-85b0-\
ab142f8bb0c0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", " ", "all", " ", "relevant", " ", "bias"}], " ", "+", 
    " ", 
    RowBox[{"RSD", " ", "coefficients"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"b1s", "=", 
     RowBox[{"{", 
      RowBox[{"b1", ",", "f"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b2s", "=", 
     RowBox[{"{", 
      RowBox[{"b2", ",", "g2", ",", "b1", ",", "f", ",", " ", 
       RowBox[{"b1", " ", "f"}], ",", " ", 
       SuperscriptBox["f", "2"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"biasListB211", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"b2s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"b1s", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"b1s", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "b2s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "b1s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "b1s", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{
      "\"\<`` contributions to \!\(\*SubscriptBox[\(B\), \(211\)]\)\>\"", ",", 
       RowBox[{"Length", "[", "biasListB211", "]"}]}], "]"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.854661722453184*^9, 3.8546617733419228`*^9}, {
   3.8546618110218687`*^9, 3.854662016105537*^9}, {3.855069086642674*^9, 
   3.855069106416951*^9}, {3.85523894394874*^9, 3.8552389440560303`*^9}, 
   3.861713812420974*^9, 3.8617142205262413`*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"4bc7bf35-5a77-4c05-99d8-d670345e4a30"],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*RowBox[{\\\"14\\\"}]\\) contributions to \\!\
\\(\\*SubscriptBox[\\(B\\), \\(211\\)]\\)\"\>",
  StringForm["`` contributions to \!\(\*SubscriptBox[\(B\), \(211\)]\)", 14],
  Editable->False]], "Print",
 CellChangeTimes->{3.861714220870768*^9},
 CellLabel->
  "During evaluation of \
In[66]:=",ExpressionUUID->"4b3a5977-f49e-4479-ae4d-1a8175022a15"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"B211", "[", 
    RowBox[{
    "k1_", ",", "k2_", ",", "k3_", ",", "\[Mu]1_", ",", "\[Mu]2_", ",", 
     "\[Mu]3_"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Z1s", "[", "k1", "]"}], 
            RowBox[{"Z1s", "[", "k2", "]"}], 
            RowBox[{"Z2s", "[", 
             RowBox[{"k1", ",", "k2"}], "]"}], 
            RowBox[{"Plin", "[", "k1", "]"}], 
            RowBox[{"Plin", "[", "k2", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Z1s", "[", "k1", "]"}], 
            RowBox[{"Z1s", "[", "k3", "]"}], 
            RowBox[{"Z2s", "[", 
             RowBox[{"k1", ",", "k3"}], "]"}], 
            RowBox[{"Plin", "[", "k1", "]"}], 
            RowBox[{"Plin", "[", "k3", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Z1s", "[", "k2", "]"}], 
            RowBox[{"Z1s", "[", "k3", "]"}], 
            RowBox[{"Z2s", "[", 
             RowBox[{"k2", ",", "k3"}], "]"}], 
            RowBox[{"Plin", "[", "k2", "]"}], 
            RowBox[{"Plin", "[", "k3", "]"}]}]}], ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"al", "\[Rule]", "alfm"}], ",", 
          RowBox[{"be", "\[Rule]", "befm"}]}], "}"}]}], ")"}], "/.", 
      "muSubsExt"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}], ",", 
       RowBox[{
        RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
       RowBox[{
        RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"k1", "+", "k2"}], "]"}], "\[Rule]", "k3"}], ",", 
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"k1", "+", "k3"}], "]"}], "\[Rule]", "k2"}], ",", 
       RowBox[{
        RowBox[{"mag", "[", 
         RowBox[{"k2", "+", "k3"}], "]"}], "\[Rule]", "k1"}]}], "}"}]}], "//",
     "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.854718826631465*^9, {3.8550693195844316`*^9, 3.855069327510283*^9}, 
   3.855069457639307*^9, {3.855069606439948*^9, 3.8550696091626863`*^9}, 
   3.855239181467122*^9, 3.8617138179244633`*^9},
 CellLabel->
  "In[132]:=",ExpressionUUID->"ec6816f9-da9a-4536-a8b8-c899b2a80889"]
}, Closed]],

Cell[CellGroupData[{

Cell["B222 Kernel", "Subsection",
 CellChangeTimes->{{3.853958463736459*^9, 3.85395846540586*^9}, {
   3.855069968274898*^9, 3.855069970789865*^9}, 
   3.855090017900682*^9},ExpressionUUID->"e0cd41f5-14ba-48a6-8c99-\
f0a2d273176d"],

Cell[TextData[{
 "Here, we compute the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "222"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5654191d-8939-42d1-961b-0807fbfe72f8"],
 " kernel. Explicitly, we expand the full kernel and perform various angular \
substitutions to transform it into the form required for the FFTLog \
algorithm. Note that the kernel is only computed if it does not already exist \
in the output directory. Below, we fix ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "1"], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["\[Mu]", "2"]}], "=", 
     RowBox[{"-", 
      SubscriptBox["\[Mu]", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "364134a1-cb4c-4cfd-9a30-9f827dacd11f"],
 " to account for flatness. We also have the condition Sqrt[x]+Sqrt[y]=1, but \
we will impose that later for cleanliness."
}], "Text",
 CellChangeTimes->{{3.861705437738172*^9, 3.861705530716465*^9}, {
  3.861713964749469*^9, 
  3.861713965677194*^9}},ExpressionUUID->"331795d0-3cfd-494c-92b3-\
e4f4556e80fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", " ", "all", " ", "relevant", " ", "bias"}], " ", "+", 
    " ", 
    RowBox[{"RSD", " ", "coefficients"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"biasListB222", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"b2s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"b2s", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"b2s", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "b2s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "b2s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "b2s", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{
      "\"\<`` contributions to \!\(\*SubscriptBox[\(B\), \(222\)]\)\>\"", ",", 
       RowBox[{"Length", "[", "biasListB222", "]"}]}], "]"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.854662482567525*^9, 3.854662508340727*^9}, {
   3.855070700059454*^9, 3.855070709910523*^9}, {3.855240240800193*^9, 
   3.855240241252261*^9}, {3.858412022055497*^9, 3.858412022833239*^9}, 
   3.861705514108889*^9, {3.861706059057658*^9, 3.861706068505131*^9}, 
   3.8617139733924227`*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"c3e46801-42c6-4ec7-8424-c642aac833ff"],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*RowBox[{\\\"50\\\"}]\\) contributions to \\!\
\\(\\*SubscriptBox[\\(B\\), \\(222\\)]\\)\"\>",
  StringForm["`` contributions to \!\(\*SubscriptBox[\(B\), \(222\)]\)", 50],
  Editable->False]], "Print",
 CellChangeTimes->{{3.8617060697022247`*^9, 3.8617060758284397`*^9}, {
  3.861714215025865*^9, 3.861714223405651*^9}},
 CellLabel->
  "During evaluation of \
In[70]:=",ExpressionUUID->"0fc4a7cc-a43c-41cf-9d1e-edcc47eed1ea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Raw", " ", "B222", " ", "kernel"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ker222raw", "=", 
     RowBox[{"8", " ", 
      RowBox[{"Z2s", "[", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{"q", "+", "k1"}]}], "]"}], 
      RowBox[{"Z2s", "[", 
       RowBox[{
        RowBox[{"q", "+", "k1"}], ",", 
        RowBox[{
         RowBox[{"-", "q"}], "+", "k2"}]}], "]"}], 
      RowBox[{"Z2s", "[", 
       RowBox[{
        RowBox[{"k2", "-", "q"}], ",", "q"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplify", " ", "and", " ", "find", " ", "coefficients"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"NB", ":", " ", 
     RowBox[{
     "the", " ", "RSD", " ", "expression", " ", "includes", " ", "powers", 
      " ", "up", " ", "to", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"q", ".", "z"}], ")"}], "6"], " ", "in", " ", "this", " ", 
      RowBox[{"instance", "."}]}]}], " ", "*)"}], "\n", 
   RowBox[{"Clear", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ker222init", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ker222raw", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"al", "\[Rule]", "alfm"}], ",", 
                 RowBox[{"be", "\[Rule]", "befm"}]}], "}"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"-", "x_"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"-", 
                 RowBox[{"\[Eta]", "[", "x", "]"}]}]}], "}"}]}], ")"}], "/.", 
            "muSubsExt"}], "/.", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"-", "q"}], "]"}], "\[Rule]", 
            RowBox[{"mag", "[", "q", "]"}]}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"k1", "+", "k2"}], "]"}], "\[Rule]", "k3"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}]}], "}"}]}], 
        ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k1", "\[Rule]", "1"}], ",", 
         RowBox[{"k2", "\[Rule]", 
          SqrtBox["y"]}], ",", 
         RowBox[{"k3", "\[Rule]", 
          SqrtBox["x"]}]}], "}"}]}], "//", "Expand"}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Simplify", " ", "and", " ", "insert", " ", "flattened", " ", "angle", 
     " ", 
     RowBox[{
      RowBox[{"definitions", " ", "[", 
       RowBox[{
        RowBox[{"can", " ", "do", " ", "so", " ", "here"}], ",", " ", 
        RowBox[{
         RowBox[{"since", " ", "x"}], " ", "<", " ", "y", " ", "<", " ", 
         RowBox[{"1", " ", "is", " ", "ensured"}]}]}], "]"}], "."}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ker222", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ker222init", "/.", "muSubs"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", " ", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["k1pq", "2"], "-", "1", "-", 
              SuperscriptBox["q", "2"]}], ")"}], 
            RowBox[{"2", " ", "q"}]]}], ",", 
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k2", ",", "q"}], "]"}], "\[Rule]", " ", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"y", "+", 
              SuperscriptBox["q", "2"], "-", 
              SuperscriptBox["k2mq", "2"]}], ")"}], 
            RowBox[{"2", " ", 
             RowBox[{"Sqrt", "[", "y", "]"}], "q"}]]}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Mu]2", "\[Rule]", 
          RowBox[{"-", "\[Mu]1"}]}], ",", 
         RowBox[{"\[Mu]3", "\[Rule]", 
          RowBox[{"-", "\[Mu]1"}]}]}], "}"}]}], "//", "Expand"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.854662482567525*^9, 3.854662508340727*^9}, {
   3.855070700059454*^9, 3.855070709910523*^9}, {3.855240240800193*^9, 
   3.855240241252261*^9}, {3.858412022055497*^9, 3.858412022833239*^9}, 
   3.861705514108889*^9, {3.861706059057658*^9, 3.861706068505131*^9}, {
   3.861713980740987*^9, 3.861713984993599*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"92b9d2bf-eae8-4b46-be85-d606d7e653a7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<tab222derivs-flat.wdx\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Load", " ", "kernels", " ", "from", " ", "disk"}], ",", " ", 
      RowBox[{"if", " ", "already", " ", "computed"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Loading pre-computed kernels\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Tab222", "=", 
      RowBox[{"Import", "[", "\"\<tab222-flat.wdx\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab222derivs", "=", 
      RowBox[{"Import", "[", "\"\<tab222derivs-flat.wdx\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab222freq", " ", "=", " ", 
      RowBox[{"Import", "[", "\"\<tab222freq-flat.wdx\>\"", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"(*", " ", 
     RowBox[{"Else", ",", " ", 
      RowBox[{"compute", " ", "from", " ", "scratch"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Starting \!\(\*SubscriptBox[\(B\), \(222\)]\) kernel \
computation...\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"First", ",", " ", 
       RowBox[{
       "tabulate", " ", "all", " ", "possible", " ", "powers", " ", "of", " ",
         "q"}], ",", " ", 
       RowBox[{"|", 
        RowBox[{"k1", "+", "q"}], "|"}], ",", " ", 
       RowBox[{"|", 
        RowBox[{"k2", "-", "q"}], "|"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Tabulating polynomial coefficients\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab222init", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], 
           FractionBox["q", 
            RowBox[{
            "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              ",", "q"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], 
           FractionBox["k1pq", 
            RowBox[{
            "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              ",", "k1pq"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", "2"]}], 
           FractionBox["k2mq", 
            RowBox[{
            "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              ",", "k2mq"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{
           "ker222", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"q", "\[Rule]", "1"}], ",", 
             RowBox[{"k1pq", "\[Rule]", "1"}], ",", 
             RowBox[{"k2mq", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "ker222", "]"}]}], "}"}]}], "]"}]}], ";", 
     RowBox[{"minpow", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Tab222init", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxpow", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Tab222init", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{";;", "3"}]}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pom", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "minpow"}], ",", 
       RowBox[{"i1", "\[LessEqual]", "maxpow"}], ",", 
       RowBox[{"i1", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "minpow"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxpow"}], ",", 
         RowBox[{"i2", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "minpow"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxpow"}], ",", 
           RowBox[{"i3", "++"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"Tab222init", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "_"}], "}"}]}], 
                "]"}], "]"}], ">", "0"}], ",", 
             RowBox[{"pom", "=", 
              RowBox[{"pom", "+", "1"}]}]}], "]"}]}], "]"}]}], "]"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Now", " ", "create", " ", "simplified", " ", "table", " ", "with", 
        " ", "these", " ", "powers"}], " ", "+", " ", 
       RowBox[{"their", " ", "coefficients"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Preparing output table\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab222", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "pom"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "minpow"}], ",", 
       RowBox[{"i1", "\[LessEqual]", " ", "maxpow"}], ",", 
       RowBox[{"i1", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "minpow"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxpow"}], ",", 
         RowBox[{"i2", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "minpow"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxpow"}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"Tab222init", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "_"}], "}"}]}], 
                "]"}], "]"}], ">", "0"}], ",", 
             RowBox[{
              RowBox[{"pom", "=", 
               RowBox[{"Cases", "[", 
                RowBox[{"Tab222init", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2", ",", "i3", ",", "_"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"pom2", "=", "0"}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"i", "=", "1"}], ",", 
                RowBox[{"i", "\[LessEqual]", 
                 RowBox[{"Length", "[", "pom", "]"}]}], ",", 
                RowBox[{"i", "++"}], ",", 
                RowBox[{"pom2", "=", 
                 RowBox[{"pom2", "+", 
                  RowBox[{"pom", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}]}]}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tab222", "\[LeftDoubleBracket]", 
                RowBox[{"counter", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"pom", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                FractionBox["\[Nu]1", "2"]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tab222", "\[LeftDoubleBracket]", 
                RowBox[{"counter", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"pom", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
                FractionBox["\[Nu]2", "2"]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tab222", "\[LeftDoubleBracket]", 
                RowBox[{"counter", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"pom", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "-", 
                FractionBox["\[Nu]3", "2"]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Tab222", "\[LeftDoubleBracket]", 
                RowBox[{"counter", ",", "4"}], "\[RightDoubleBracket]"}], "=",
                "pom2"}], ";", "\[IndentingNewLine]", 
              RowBox[{"counter", "=", 
               RowBox[{"counter", "+", "1"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"save", " ", "output", " ", "table"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Saving results\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab222-flat.wdx\>\"", ",", "Tab222"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Define", " ", "table", " ", "derivatives", " ", "and", " ", 
       "frequencies"}], " ", "*)"}], "  ", 
     RowBox[{"Tab222derivs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"Tab222", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
           RowBox[{"biasListB222", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f", "\[Rule]", "0"}], ",", 
           RowBox[{"b1", "\[Rule]", "0"}], ",", 
           RowBox[{"b2", "\[Rule]", "0"}], ",", 
           RowBox[{"g2", "\[Rule]", "0"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "biasListB222", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab222derivs-flat.wdx\>\"", ",", "Tab222derivs"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Tab222freq", "=", 
      RowBox[{"Tab222", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{";;", "3"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab222freq-flat.wdx\>\"", ",", "Tab222freq"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Calculations complete!\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8556828894923553`*^9, 3.855682890116631*^9}, {
   3.85569430436322*^9, 3.8556943075867662`*^9}, {3.8584114776626062`*^9, 
   3.858411478298789*^9}, {3.8584115552001953`*^9, 3.858411556453268*^9}, {
   3.859276980868189*^9, 3.859276991391788*^9}, 3.859883479886491*^9, {
   3.86170591908036*^9, 3.861706045107379*^9}, {3.8617060871839542`*^9, 
   3.861706214473073*^9}, {3.8617062771032953`*^9, 3.861706277418665*^9}, {
   3.861706348570355*^9, 3.86170654077227*^9}, {3.861714003325573*^9, 
   3.861714102318583*^9}, {3.861714194057411*^9, 3.861714237671122*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"62623235-dd2b-4149-a14e-33c4da5dafc5"],

Cell[BoxData["\<\"Loading pre-computed kernels\"\>"], "Print",
 CellChangeTimes->{
  3.861706338440246*^9, 3.861706544018853*^9, 3.861712678963944*^9, {
   3.8617140810020647`*^9, 3.861714102597373*^9}, 3.861714133454611*^9, {
   3.861714169784059*^9, 3.861714237946885*^9}, 3.8617156217710123`*^9},
 CellLabel->
  "During evaluation of \
In[126]:=",ExpressionUUID->"4ee369bb-f57c-4775-89e9-e39a74cd1b8d"]
}, Open  ]],

Cell[TextData[{
 "Now we can extract specific coefficients; there are 50 possibilities in \
total. Note that bias renormalization does not affect any ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "222"], TraditionalForm]],ExpressionUUID->
  "5d09da6d-28a8-43e3-8034-12809942d593"],
 "diagrams of this type."
}], "Text",
 CellChangeTimes->{{3.853959802384461*^9, 3.8539598083128147`*^9}, {
  3.853967669720723*^9, 3.853967670226543*^9}, {3.853968784488686*^9, 
  3.8539688450944757`*^9}, {3.854286454685451*^9, 3.8542864675453577`*^9}, {
  3.854476421044091*^9, 3.854476435709188*^9}, {3.8550795713601513`*^9, 
  3.855079571611305*^9}, {3.858412567388033*^9, 
  3.858412567637189*^9}},ExpressionUUID->"29f54ffa-694b-4253-a9a4-\
d038f502e1c1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExtractCoeff", "[", 
   RowBox[{"TabInput_", ",", "Factor_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TabInput", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"TabInput", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"TabInput", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"TabInput", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}], ",", "Factor"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "TabInput", "]"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "0"}], "}"}], "\[Rule]", 
    "Nothing"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tab222fb1b2b2", "=", 
    RowBox[{"ExtractCoeff", "[", 
     RowBox[{"Tab222", ",", 
      RowBox[{"f", " ", "b1", " ", 
       SuperscriptBox["b2", "2"]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Print", " ", "one", " ", "coefficient", " ", "for", " ", "illustration"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Tab222ffg2g2", "=", 
  RowBox[{
   RowBox[{"ExtractCoeff", "[", 
    RowBox[{"Tab222", ",", 
     RowBox[{
      SuperscriptBox["f", "2"], " ", 
      SuperscriptBox["g2", "2"]}]}], "]"}], "[", 
   RowBox[{"[", "63", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.853959051597268*^9, 3.853959249137271*^9}, {
   3.8539592859005404`*^9, 3.853959425533422*^9}, {3.85395951910223*^9, 
   3.853959553161378*^9}, {3.853959632377915*^9, 3.853959645376631*^9}, 
   3.8539596763395367`*^9, {3.853959728227519*^9, 3.8539598216636963`*^9}, {
   3.853961012511876*^9, 3.853961074637065*^9}, {3.853967293173581*^9, 
   3.853967295944956*^9}, {3.853967560304821*^9, 3.853967562099866*^9}, {
   3.8539678469564657`*^9, 3.853967848484446*^9}, {3.853968090478551*^9, 
   3.853968092100464*^9}, {3.854141829034429*^9, 3.8541418737371902`*^9}, {
   3.854286472836478*^9, 3.854286478620448*^9}, {3.854476441316572*^9, 
   3.854476447001309*^9}, {3.854476993831831*^9, 3.854476994667831*^9}, {
   3.8545603773645973`*^9, 3.854560381586473*^9}, {3.855079574127842*^9, 
   3.855079598999951*^9}, {3.858416499778287*^9, 3.858416506615306*^9}, 
   3.859277067203998*^9, {3.859278387867043*^9, 3.859278398367231*^9}, 
   3.859576902044612*^9, {3.859624401606691*^9, 3.859624402269547*^9}, 
   3.861712684685491*^9, {3.861714268612308*^9, 3.861714279676345*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"e97588c7-df2c-4664-8517-a437fb0df8e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", "-", 
    FractionBox["\[Nu]1", "2"]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    FractionBox["\[Nu]2", "2"]}], ",", 
   RowBox[{"-", 
    FractionBox["\[Nu]3", "2"]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["\[Mu]1", "2"], "16"]}], "-", 
    FractionBox[
     RowBox[{"3", " ", "x", " ", 
      SuperscriptBox["\[Mu]1", "2"]}], "16"], "+", 
    FractionBox[
     SuperscriptBox["\[Mu]1", "4"], "16"], "+", 
    FractionBox[
     RowBox[{"7", " ", "x", " ", 
      SuperscriptBox["\[Mu]1", "4"]}], "16"], "-", 
    RowBox[{
     FractionBox["1", "8"], " ", "x", " ", 
     SqrtBox["y"], " ", 
     SuperscriptBox["\[Mu]1", "4"]}], "-", 
    RowBox[{
     FractionBox["1", "8"], " ", 
     SuperscriptBox["y", 
      RowBox[{"3", "/", "2"}]], " ", 
     SuperscriptBox["\[Mu]1", "4"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.861712716714964*^9, {3.861714261520177*^9, 3.861714280047963*^9}},
 CellLabel->"Out[88]=",ExpressionUUID->"e616cdcc-5c21-4132-a27c-5de64c64b85a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["B321-I Kernel", "Subsection",
 CellChangeTimes->{{3.8539610785857487`*^9, 3.853961091211481*^9}, {
   3.8539611875578938`*^9, 3.8539611938443527`*^9}, {3.853961371972602*^9, 
   3.853961372189085*^9}, {3.855069972114443*^9, 3.85506997310824*^9}, 
   3.85509523466354*^9, 
   3.861706558031534*^9},ExpressionUUID->"c35d043d-6527-47ce-8806-\
aeb233403bb5"],

Cell[TextData[{
 "We now repeat for the B321-I kernel. Note that permutations are added only \
in the final stage. Note also that  we do not impose the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", "i"], "=", 
    RowBox[{
     RowBox[{"(", "-", ")"}], " ", 
     SubscriptBox["\[Mu]", "j"]}]}], TraditionalForm]],ExpressionUUID->
  "b003836c-c10e-4117-a391-2a860eeba63a"],
 " conditions here - this is done only in the final stage to make sure we \
treat permutation symmetries correctly."
}], "Text",
 CellChangeTimes->{{3.861706559225848*^9, 3.8617065762563953`*^9}, {
  3.8617142940365343`*^9, 
  3.8617143273165703`*^9}},ExpressionUUID->"95ac1deb-312c-443f-810a-\
6ba8a2bf24d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", " ", "all", " ", "relevant", " ", "bias"}], " ", "+", 
    " ", 
    RowBox[{"RSD", " ", "coefficients"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"b3sI", "=", 
     RowBox[{"{", 
      RowBox[{
      "b3", ",", "g2x", ",", " ", "g3", ",", " ", "g21", ",", " ", "b2", ",", 
       "g2", ",", "b1", ",", 
       SuperscriptBox["f", "3"], ",", 
       RowBox[{"b1", " ", 
        SuperscriptBox["f", "2"]}], ",", 
       SuperscriptBox["f", "2"], ",", 
       RowBox[{"b2", " ", "f"}], ",", " ", 
       RowBox[{"g2", " ", "f"}], ",", " ", 
       RowBox[{"b1", " ", "f"}], ",", "f"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"biasListB321I", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"b3sI", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"b2s", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"b1s", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "b3sI", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "b2s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "b1s", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{
      "\"\<`` contributions to \!\(\*SubscriptBox[\(B\), \(321 - I\)]\)\>\"", 
       ",", 
       RowBox[{"Length", "[", "biasListB321I", "]"}]}], "]"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.855089467207789*^9, 3.855089490506912*^9}, {
  3.8617127426485233`*^9, 3.8617127432203913`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"58b1069c-ae01-4ee8-9506-2ca161fb16d1"],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*RowBox[{\\\"86\\\"}]\\) contributions to \\!\
\\(\\*SubscriptBox[\\(B\\), \\(321 - I\\)]\\)\"\>",
  StringForm[
  "`` contributions to \!\(\*SubscriptBox[\(B\), \(321 - I\)]\)", 86],
  Editable->False]], "Print",
 CellChangeTimes->{{3.855089480887998*^9, 3.8550894910900583`*^9}, 
   3.855149089131263*^9, 3.855237407182913*^9, 3.855237507916259*^9, 
   3.855240872713846*^9, 3.8552415415886507`*^9, 3.8552477453413553`*^9, 
   3.855248165170422*^9, 3.855252370305025*^9, 3.855312834398018*^9, 
   3.855324376120009*^9, 3.8557429765525293`*^9, 3.855743350570044*^9, 
   3.855744830539433*^9, 3.8557503907912607`*^9, 3.855752016848465*^9, 
   3.855753342994445*^9, 3.8557552320809107`*^9, 3.8557553986935167`*^9, 
   3.858417245354806*^9, 3.858420864494857*^9, 3.858449189150423*^9, 
   3.85919659692738*^9, 3.859278682571525*^9, 3.8593674981444387`*^9, {
   3.859465078801816*^9, 3.859465088656652*^9}, 3.859577546248151*^9, {
   3.861712716927285*^9, 3.861712743513278*^9}, 3.861714332237059*^9},
 CellLabel->
  "During evaluation of \
In[89]:=",ExpressionUUID->"f8709785-dc7c-45e3-8a11-d78e1b4f1b88"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Define", " ", "kernel"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ker321raw", " ", "=", " ", 
     RowBox[{"6", 
      RowBox[{"Z3s", "[", 
       RowBox[{
        RowBox[{"-", "q"}], ",", 
        RowBox[{"q", "-", "k2"}], ",", 
        RowBox[{"-", "k1"}]}], "]"}], 
      RowBox[{"Z2s", "[", 
       RowBox[{"q", ",", 
        RowBox[{"k2", "-", "q"}]}], "]"}], 
      RowBox[{"Z1s", "[", "k1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplify", " ", "and", " ", "find", " ", "coefficients"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"NB", ":", " ", 
     RowBox[{
     "the", " ", "RSD", " ", "expression", " ", "includes", " ", "powers", 
      " ", "up", " ", "to", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"q", ".", "z"}], ")"}], "6"], " ", "in", " ", "this", " ", 
      RowBox[{"instance", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ker321init", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ker321raw", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ang1", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], ",", 
                   RowBox[{
                    RowBox[{"-", "k2"}], "+", "q"}]}], "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{
                   FractionBox["k2", "k2mq"], 
                   RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "k2"}], "]"}]}], "-", 
                  RowBox[{
                   FractionBox["q", "k2mq"], 
                   RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "q"}], "]"}]}]}]}], ",", 
                RowBox[{
                 RowBox[{"ang1", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "k2"}], "+", "q"}], ",", 
                   RowBox[{"-", "k1"}]}], "]"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{
                   FractionBox["k2", "k2mq"], 
                   RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "k2"}], "]"}]}], "-", 
                  RowBox[{
                   FractionBox["q", "k2mq"], 
                   RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "q"}], "]"}]}]}]}], ",", 
                RowBox[{
                 RowBox[{"ang1", "[", 
                  RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
                 RowBox[{"ang", "[", 
                  RowBox[{"a", ",", "b"}], "]"}]}]}], "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"-", "x_"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"-", 
                RowBox[{"\[Eta]", "[", "x", "]"}]}]}], "}"}]}], "/.", 
            "muSubsExt"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"al", "\[Rule]", "alfm"}], ",", 
             RowBox[{"be", "\[Rule]", "befm"}]}], "}"}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"mag", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"-", "q"}], "]"}], "\[Rule]", 
            RowBox[{"mag", "[", "q", "]"}]}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"-", "k1"}], "]"}], "\[Rule]", 
            RowBox[{"mag", "[", "k1", "]"}]}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"-", "k2"}], "]"}], "\[Rule]", 
            RowBox[{"mag", "[", "k2", "]"}]}]}], "}"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "k2"}], "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{
            RowBox[{"-", "k1"}], "-", "k2"}], "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{
            RowBox[{"-", "k1"}], "-", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
         
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{
            RowBox[{"-", "k2"}], "+", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
         
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "k2", "+", "q"}], "]"}], "\[Rule]", "k3mq"}], 
         ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "k2", "-", "q"}], "]"}], "\[Rule]", "k3pq"}], 
         ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{
            RowBox[{"-", "k1"}], "-", "k2", "+", "q"}], "]"}], "\[Rule]", 
          "k3pq"}]}], "}"}]}], "//", "Expand"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ker321", "=", 
     RowBox[{
      RowBox[{"ker321init", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"k1", "\[Rule]", "1"}], ",", 
         RowBox[{"k2", "\[Rule]", 
          SqrtBox["y"]}], ",", 
         RowBox[{"k3", "\[Rule]", 
          SqrtBox["x"]}]}], "}"}]}], "//", "Expand"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.861706592412346*^9, 3.861706874390238*^9}, {
   3.861712843160837*^9, 3.861712850330298*^9}, 3.861714343952813*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"15467d6d-21a7-4de2-9635-0a75cf80ce30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<tab321derivs-flat.wdx\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Load", " ", "kernels", " ", "from", " ", "disk"}], ",", " ", 
      RowBox[{"if", " ", "already", " ", "computed"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Loading pre-computed kernels\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Tab321", "=", 
      RowBox[{"Import", "[", "\"\<tab321I-flat.wdx\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab321freq", " ", "=", " ", 
      RowBox[{"Import", "[", "\"\<tab321freq-flat.wdx\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab321derivs", "=", 
      RowBox[{"Import", "[", "\"\<tab321derivs-flat.wdx\>\"", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"(*", " ", 
     RowBox[{"Else", ",", " ", 
      RowBox[{"compute", " ", "from", " ", "scratch"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Starting \!\(\*SuperscriptBox[SubscriptBox[\(B\), \(321\)], \(I\)]\
\) kernel computation...\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ker321red12", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ker321red23", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Evaluating symmetries\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ker321", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pom1", "=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker321", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", "k1pq"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"k1pq", "\[Rule]", "1"}], ",", 
            RowBox[{"k2mq", "\[Rule]", "1"}], ",", 
            RowBox[{"k3pq", "\[Rule]", "1"}], ",", 
            RowBox[{"q", "\[Rule]", "1"}], ",", 
            RowBox[{"x", "\[Rule]", "1"}], ",", 
            RowBox[{"y", "\[Rule]", "1"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"NB", ":", " ", 
           RowBox[{
           "if", " ", "clause", " ", "can", " ", "be", " ", "true"}]}], ",", 
          " ", 
          RowBox[{"false", " ", "or", " ", 
           RowBox[{"indeterminate", ".", " ", "Indeterminate"}], " ", "case", 
           " ", "is", " ", "the", " ", "same", " ", "as", " ", "false", " ", 
           "here"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pom1", "\[Equal]", "0"}], ",", 
          RowBox[{"ker321red23", "=", 
           RowBox[{"ker321red23", "+", 
            RowBox[{
            "ker321", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"ker321red12", "=", 
           RowBox[{"ker321red12", "+", 
            RowBox[{
            "ker321", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"ker321red12", "=", 
           RowBox[{"ker321red12", "+", 
            RowBox[{
            "ker321", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Expand", " ", "RSD", " ", "angular", " ", "dependence", " ", "in", " ",
        "ker321red12", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"in", " ", "terms", " ", "of", " ", "\[Mu]1", " ", "and"}], 
         " ", "|", 
         RowBox[{"k1", "+", "q"}], "|"}], " "}]}], "*)"}], 
     RowBox[{"ker321red12", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ker321red12", "/.", "muSubs"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", " ", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["k1pq", "2"], "-", "1", "-", 
              SuperscriptBox["q", "2"]}], ")"}], 
            RowBox[{"2", " ", "q"}]]}], ",", 
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k2", ",", "q"}], "]"}], "\[Rule]", " ", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"y", "+", 
              SuperscriptBox["q", "2"], "-", 
              SuperscriptBox["k2mq", "2"]}], ")"}], 
            RowBox[{"2", " ", 
             RowBox[{"Sqrt", "[", "y", "]"}], " ", "q"}]]}]}], "}"}]}], "//", 
       "Expand"}]}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Expand", " ", "RSD", " ", "angular", " ", "dependence", " ", "in", " ",
        "ker321red23", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"in", " ", "terms", " ", "of", " ", "\[Mu]3", " ", "and"}], 
         " ", "|", 
         RowBox[{"k3", "+", "q"}], "|"}], " "}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"muSubs32", "=", 
      RowBox[{"muSubs", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]3"}], ",", 
         RowBox[{
          RowBox[{"ang1", "[", 
           RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
          RowBox[{"ang1", "[", 
           RowBox[{"k3", ",", "q"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ker321red23", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ker321red23", "/.", "muSubs32"}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k3", ",", "q"}], "]"}], "\[Rule]", " ", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["k3pq", "2"], "-", "x", "-", 
              SuperscriptBox["q", "2"]}], ")"}], 
            RowBox[{"2", " ", 
             RowBox[{"Sqrt", "[", "x", "]"}], "q"}]]}], ",", 
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k2", ",", "q"}], "]"}], "\[Rule]", " ", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"y", "+", 
              SuperscriptBox["q", "2"], "-", 
              SuperscriptBox["k2mq", "2"]}], ")"}], 
            RowBox[{"2", " ", 
             RowBox[{"Sqrt", "[", "y", "]"}], " ", "q"}]]}]}], "}"}]}], "//", 
       "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Tabulating polynomial coefficients\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Combine", " ", "together", " ", "and", " ", "include", " ", 
       RowBox[{"symmetries", " ", "[", 
        RowBox[{
         RowBox[{"NB", ":", " ", 
          RowBox[{
          "these", " ", "only", " ", "affect", " ", "terms", " ", "involving",
            " ", "q"}]}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "not"}], " ", 
          SubscriptBox["\[Nu]", "ij"], " ", "or", " ", 
          SubscriptBox["\[Mu]", 
           RowBox[{"i", " "}]]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ker321final", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "\[Nu]1"], 
          SuperscriptBox["k2mq", "\[Nu]2"], "ker321red12"}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q", "\[Nu]1"], 
               SuperscriptBox["k2mq", "\[Nu]2"], "ker321red23"}], "//", 
              "Expand"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "k2pqt"}], ",", 
              RowBox[{"k2mq", "\[Rule]", "qt"}], ",", 
              RowBox[{"k3pq", "\[Rule]", "k1mqt"}]}], "}"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"qt", "\[Rule]", "q"}], ",", 
            RowBox[{"k1mqt", "\[Rule]", "k1pq"}], ",", 
            RowBox[{"k2pqt", "\[Rule]", "k2mq"}]}], "}"}]}], ")"}]}], "//", 
       "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Construct", " ", "output", " ", "table"}], " ", "*)"}], 
     RowBox[{"Tab321step1", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            FractionBox["q", 
             RowBox[{
             "ker321final", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker321final", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "q"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            FractionBox["k1pq", 
             RowBox[{
             "ker321final", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker321final", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            FractionBox["k2mq", 
             RowBox[{
             "ker321final", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker321final", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
            "ker321final", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "1"}], ",", 
              RowBox[{"k1pq", "\[Rule]", "1"}], ",", 
              RowBox[{"k2mq", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ker321final", "]"}]}], "}"}]}], "]"}], "//",
        "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"minpow", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Tab321step1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", "3"}]}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Nu]1", "\[Rule]", "0"}], ",", 
          RowBox[{"\[Nu]2", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxpow", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Tab321step1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", "3"}]}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Nu]1", "\[Rule]", "0"}], ",", 
          RowBox[{"\[Nu]2", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pom", "=", "0"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "minpow"}], ",", 
       RowBox[{"i1", "\[LessEqual]", "maxpow"}], ",", 
       RowBox[{"i1", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "minpow"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxpow"}], ",", 
         RowBox[{"i2", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "minpow"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxpow"}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Tab321step1", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i1", "-", 
                    FractionBox["\[Nu]1", "2"]}], ",", "i2", ",", 
                    RowBox[{"i3", "-", 
                    FractionBox["\[Nu]2", "2"]}], ",", "_"}], "}"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"pom", "=", 
               RowBox[{"pom", "+", "1"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Tab321step1", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i1", "-", 
                    FractionBox["\[Nu]2", "2"]}], ",", "i2", ",", 
                    RowBox[{"i3", "-", 
                    FractionBox["\[Nu]1", "2"]}], ",", "_"}], "}"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"pom", "=", 
               RowBox[{"pom", "+", "1"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Preparing output table\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab321", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "pom"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "minpow"}], ",", 
       RowBox[{"i1", "\[LessEqual]", "maxpow"}], ",", 
       RowBox[{"i1", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "minpow"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxpow"}], ",", 
         RowBox[{"i2", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "minpow"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxpow"}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pom", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"Tab321step1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i1", "-", 
                  FractionBox["\[Nu]1", "2"]}], ",", "i2", ",", 
                 RowBox[{"i3", "-", 
                  FractionBox["\[Nu]2", "2"]}], ",", "_"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pom", "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Tab321", "\[LeftDoubleBracket]", "counter", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i1", "-", 
                   FractionBox["\[Nu]1", "2"]}], ",", "i2", ",", 
                  RowBox[{"i3", "-", 
                   FractionBox["\[Nu]2", "2"]}], ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"pom", " ", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
               RowBox[{"counter", "=", 
                RowBox[{"counter", "+", "1"}]}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pom", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"Tab321step1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i1", "-", 
                  FractionBox["\[Nu]2", "2"]}], ",", "i2", ",", 
                 RowBox[{"i3", "-", 
                  FractionBox["\[Nu]1", "2"]}], ",", "_"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pom", "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Tab321", "\[LeftDoubleBracket]", "counter", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i1", "-", 
                   FractionBox["\[Nu]2", "2"]}], ",", "i2", ",", 
                  RowBox[{"i3", "-", 
                   FractionBox["\[Nu]1", "2"]}], ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
               RowBox[{"counter", "=", 
                RowBox[{"counter", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Saving results\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab321I-flat.wdx\>\"", ",", "Tab321"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Define", " ", "table", " ", "derivatives", " ", "and", " ", 
       "frequencies"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Tab321derivs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"Tab321", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
           RowBox[{"biasListB321I", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"f", "->", "0"}], ",", 
           RowBox[{"b1", "->", "0"}], ",", 
           RowBox[{"b2", "->", "0"}], ",", 
           RowBox[{"g2", "->", "0"}], ",", 
           RowBox[{"b3", "->", "0"}], ",", 
           RowBox[{"g21", "->", "0"}], ",", 
           RowBox[{"g2x", "->", "0"}], ",", 
           RowBox[{"g3", "->", "0"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "biasListB321I", "]"}]}], "}"}]}], "]"}]}], 
     ";", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab321derivs-flat.wdx\>\"", ",", "Tab321derivs"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Tab321freq", "=", 
      RowBox[{"Tab321", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{";;", "3"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab321freq-flat.wdx\>\"", ",", "Tab321freq"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Calculations complete!\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.861706592412346*^9, 3.861706874390238*^9}, {
   3.861712843160837*^9, 3.861712850330298*^9}, {3.861712913112265*^9, 
   3.86171291677284*^9}, {3.861714348491934*^9, 3.861714368322192*^9}, {
   3.8617144004835777`*^9, 3.86171450022901*^9}, {3.861714583208625*^9, 
   3.861714600927751*^9}, 3.861714662103874*^9},
 CellLabel->
  "In[127]:=",ExpressionUUID->"94f96f1e-f933-48d1-9076-ab8290abdca5"],

Cell[BoxData["\<\"Loading pre-computed kernels\"\>"], "Print",
 CellChangeTimes->{
  3.861707130320567*^9, 3.861712748601149*^9, {3.86171447879443*^9, 
   3.861714500527396*^9}, {3.8617145834612827`*^9, 3.8617146013461323`*^9}, 
   3.8617147169365396`*^9, 3.86171563122504*^9},
 CellLabel->
  "During evaluation of \
In[127]:=",ExpressionUUID->"ff2cc0c1-c5ec-483b-b25e-31efa7a02064"]
}, Open  ]],

Cell["\<\
Now extract coefficients. There are lots of choices in this case: 86 in total\
\
\>", "Text",
 CellChangeTimes->{{3.855744903456305*^9, 
  3.855744904029028*^9}},ExpressionUUID->"e3feb235-a316-4a1a-8223-\
31928dc6027e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Extract", " ", "the", " ", "relevant", " ", "coefficients"}], 
    ",", " ", 
    RowBox[{"for", " ", 
     RowBox[{"example", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tab321g21b1b1", " ", "=", " ", 
     RowBox[{
      RowBox[{"ExtractCoeff", "[", 
       RowBox[{"Tab321", ",", 
        RowBox[{"f", " ", "g21", " ", 
         SuperscriptBox["b1", "2"]}]}], "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{"f", "\[Rule]", "0"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Tab321fg2b2b1", " ", "=", " ", 
    RowBox[{
     RowBox[{"ExtractCoeff", "[", 
      RowBox[{"Tab321", ",", 
       RowBox[{"f", " ", "g2", " ", "b2", " ", "b1"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"f", "\[Rule]", "0"}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8550911304858217`*^9, 3.8550911307062073`*^9}, 
   3.8550911766586018`*^9, {3.855092763763563*^9, 3.855092794778913*^9}, {
   3.855092956301799*^9, 3.855092972305945*^9}, {3.855093038351664*^9, 
   3.855093093233038*^9}, {3.855093125149201*^9, 3.8550931565099087`*^9}, {
   3.855093494524486*^9, 3.8550934962867603`*^9}, {3.85514907921902*^9, 
   3.8551491001083393`*^9}, {3.8552403479651527`*^9, 3.855240352364957*^9}, {
   3.8552426299243183`*^9, 3.8552426338367243`*^9}, {3.855253135985408*^9, 
   3.855253137074584*^9}, {3.8557425163875437`*^9, 3.855742538025754*^9}, {
   3.855744844186736*^9, 3.855744854819203*^9}, {3.855744890892734*^9, 
   3.8557449023550386`*^9}, 3.8617127516534033`*^9},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c45e8fb6-85fa-4e6a-9c27-e01165a92c8d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"2", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      SuperscriptBox["\[Mu]3", "2"], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}], "+", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "8"], "+", 
      FractionBox[
       RowBox[{"x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"2", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      RowBox[{"x", " ", 
       SuperscriptBox["\[Mu]3", "2"]}], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["3", "8"]}], " ", 
      SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      SuperscriptBox["\[Mu]3", "2"], "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"], "-", 
      FractionBox[
       RowBox[{"x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"2", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      RowBox[{"y", " ", 
       SuperscriptBox["\[Mu]3", "2"]}], "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}], "-", 
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SqrtBox["x"], " ", "y", " ", "\[Mu]1", " ", "\[Mu]3"}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}], "-", 
      FractionBox[
       RowBox[{"5", " ", "x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"], "-", 
      FractionBox[
       RowBox[{"y", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"2", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", "x", " ", "y", " ", 
      SuperscriptBox["\[Mu]3", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{
      FractionBox["1", "8"], " ", 
      SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "3"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      SuperscriptBox["\[Mu]3", "2"], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["3", "8"]}], " ", 
       SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "4"], "+", 
      FractionBox[
       RowBox[{"x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      SuperscriptBox["\[Mu]3", "2"], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"7", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "4"], " ", 
       SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"2", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "8"]}], " ", 
      SuperscriptBox["y", "2"], " ", 
      SuperscriptBox["\[Mu]3", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox["x"], " ", "\[Mu]1", " ", "\[Mu]3"}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}], "+", 
      FractionBox[
       RowBox[{"5", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"], "-", 
      FractionBox[
       RowBox[{"x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       SqrtBox["x"], " ", "y", " ", "\[Mu]1", " ", "\[Mu]3"}], "+", 
      RowBox[{
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}], "+", 
      FractionBox[
       RowBox[{"5", " ", "x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox["x"], " ", 
       SuperscriptBox["y", "2"], " ", "\[Mu]1", " ", "\[Mu]3"}], "-", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["x"], " ", 
       SuperscriptBox["y", 
        RowBox[{"3", "/", "2"}]], " ", "\[Mu]2", " ", "\[Mu]3"}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["y", "2"], " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"2", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      FractionBox["1", "8"], " ", "x", " ", 
      SuperscriptBox["y", "2"], " ", 
      SuperscriptBox["\[Mu]3", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      SuperscriptBox["\[Mu]3", "2"], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"y", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox["y", "2"], " ", 
       SuperscriptBox["\[Mu]3", "2"]}], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "2"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[Mu]3", "2"], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SqrtBox["x"], " ", 
       SqrtBox["y"], " ", "\[Mu]2", " ", "\[Mu]3"}], "-", 
      FractionBox[
       RowBox[{"x", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"], "+", 
      FractionBox[
       RowBox[{"y", " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox["x"], " ", 
       SuperscriptBox["y", 
        RowBox[{"3", "/", "2"}]], " ", "\[Mu]2", " ", "\[Mu]3"}], "+", 
      RowBox[{
       FractionBox["1", "4"], " ", "x", " ", "y", " ", 
       SuperscriptBox["\[Mu]3", "2"]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["y", "2"], " ", 
        SuperscriptBox["\[Mu]3", "2"]}], "8"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]2", "2"]}], ",", "0", ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]1", "2"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "4"]}], " ", 
       SqrtBox["x"], " ", 
       SuperscriptBox["y", 
        RowBox[{"5", "/", "2"}]], " ", "\[Mu]2", " ", "\[Mu]3"}], "-", 
      RowBox[{
       FractionBox["1", "8"], " ", "x", " ", 
       SuperscriptBox["y", "2"], " ", 
       SuperscriptBox["\[Mu]3", "2"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.861712758763062*^9, 3.8617144825775423`*^9, 
  3.861714573259059*^9, 3.8617146886115627`*^9, 3.861714719222197*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"c2be7c66-be49-4595-a7f3-be579263ff7b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["B411 Kernel", "Subsection",
 CellChangeTimes->{{3.8540259484226933`*^9, 3.8540259764715843`*^9}, {
   3.855069974372126*^9, 3.85506997534599*^9}, 3.855165898912187*^9, {
   3.8617127700381527`*^9, 
   3.861712770431567*^9}},ExpressionUUID->"7a37b377-4fce-49a2-a667-\
95fc08ff3053"],

Cell[TextData[{
 "Finally, we compute the FFTLog frequencies and coefficients for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "411"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "aff95d35-41ae-40bf-a09f-fdf31471dad3"],
 ", applying symmetries in the final step, as before. Note that this takes \
several hours to compute from scratch. As before, we do not impose the \
flatness condition on ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "i"], TraditionalForm]],ExpressionUUID->
  "f1deccb8-3c31-4839-8dc3-6704269b4521"],
 "or x,y until later, to account for symmetries."
}], "Text",
 CellChangeTimes->{{3.8617127657665586`*^9, 3.861712805939241*^9}, {
  3.861714673160557*^9, 
  3.861714673346838*^9}},ExpressionUUID->"08ad6e44-e277-4204-b50e-\
bb16087bbd46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", " ", "all", " ", "relevant", " ", "bias"}], " ", "+", 
    " ", 
    RowBox[{"RSD", " ", "coefficients"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"b4s", "=", 
     RowBox[{"{", 
      RowBox[{
      "g21x", ",", " ", "g211", ",", " ", "g22", ",", " ", "g31", ",", " ", 
       "g21", ",", "g3", ",", "b3", ",", " ", "g2x", ",", " ", "g2", ",", 
       "b2", ",", "b1", ",", 
       RowBox[{"f", " ", "b3"}], ",", " ", 
       RowBox[{"f", " ", "g2x"}], ",", " ", 
       RowBox[{"f", " ", "g3"}], ",", " ", 
       RowBox[{"f", " ", "g21"}], ",", 
       RowBox[{"f", " ", "b2"}], ",", " ", 
       RowBox[{"f", " ", "g2"}], ",", " ", 
       RowBox[{"f", " ", "b1"}], ",", " ", "f", ",", "  ", 
       RowBox[{
        SuperscriptBox["f", "2"], "b2"}], ",", " ", 
       RowBox[{
        SuperscriptBox["f", "2"], "g2"}], ",", " ", 
       RowBox[{
        SuperscriptBox["f", "2"], "b1"}], ",", " ", 
       SuperscriptBox["f", "2"], ",", 
       RowBox[{
        SuperscriptBox["f", "3"], "b1"}], ",", " ", 
       SuperscriptBox["f", "3"], ",", " ", 
       SuperscriptBox["f", "4"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"biasListB411", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"b4s", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"b1s", "[", 
           RowBox[{"[", "j", "]"}], "]"}], 
          RowBox[{"b1s", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "b4s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "b1s", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "b1s", "]"}]}], "}"}]}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{
      "\"\<`` contributions to \!\(\*SubscriptBox[\(B\), \(411\)]\)\>\"", ",", 
       RowBox[{"Length", "[", "biasListB411", "]"}]}], "]"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.85513398585824*^9, 3.855134268485314*^9}, {
   3.8552410670357027`*^9, 3.8552410676436663`*^9}, {3.855243183196067*^9, 
   3.8552431848050823`*^9}, 3.8617146794741364`*^9},
 CellLabel->
  "In[128]:=",ExpressionUUID->"0959ea30-abfa-4d28-8631-5ebced952807"],

Cell[BoxData[
 InterpretationBox["\<\"\\!\\(\\*RowBox[{\\\"70\\\"}]\\) contributions to \\!\
\\(\\*SubscriptBox[\\(B\\), \\(411\\)]\\)\"\>",
  StringForm["`` contributions to \!\(\*SubscriptBox[\(B\), \(411\)]\)", 70],
  Editable->False]], "Print",
 CellChangeTimes->{{3.855134211079039*^9, 3.8551342199123173`*^9}, 
   3.855134302443569*^9, 3.855149124837685*^9, 3.855240944608184*^9, 
   3.855242161086961*^9, 3.8552426390942*^9, 3.8552477601558123`*^9, 
   3.855248177225065*^9, 3.855253225415373*^9, 3.855253545885166*^9, 
   3.855312845380459*^9, 3.855324383275567*^9, 3.855764127200038*^9, 
   3.8558309648161573`*^9, 3.858423565219496*^9, 3.858449222011609*^9, 
   3.8592795526911097`*^9, {3.8594650721223717`*^9, 3.8594650941280746`*^9}, 
   3.8595784973941307`*^9, 3.861712808197361*^9, 3.861714738062516*^9, 
   3.861715636991344*^9},
 CellLabel->
  "During evaluation of \
In[128]:=",ExpressionUUID->"2f205b62-016c-4b0a-9b97-fea4197c1676"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"First", " ", "define", " ", "the", " ", "raw", " ", "kernel"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ker411raw", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"12", 
        RowBox[{"Z4s", "[", 
         RowBox[{"q", ",", "k1", ",", 
          RowBox[{"-", "q"}], ",", "k2"}], "]"}], 
        RowBox[{"Z1s", "[", "k1", "]"}], 
        RowBox[{"Z1s", "[", "k2", "]"}]}], ")"}], "//", "Expand"}]}], ";"}], 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Simplify", " ", "&"}], " ", "symmetrize", " ", 
     "appropriately"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angPlus", "[", 
     RowBox[{"qa_", ",", "qb_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"mag", "[", 
        RowBox[{"qa", "+", "qb"}], "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"mag", "[", "qa", "]"}], "2"], "-", 
      SuperscriptBox[
       RowBox[{"mag", "[", "qb", "]"}], "2"]}], 
     RowBox[{"2", 
      RowBox[{"mag", "[", "qa", "]"}], 
      RowBox[{"mag", "[", "qb", "]"}]}]]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"angle", " ", "between", " ", "qa", " ", "and", " ", "qb"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"angMinus", "[", 
     RowBox[{"qa_", ",", "qb_"}], "]"}], ":=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"mag", "[", 
         RowBox[{"qa", "-", "qb"}], "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"mag", "[", "qa", "]"}], "2"], "-", 
       SuperscriptBox[
        RowBox[{"mag", "[", "qb", "]"}], "2"]}], 
      RowBox[{"2", 
       RowBox[{"mag", "[", "qa", "]"}], 
       RowBox[{"mag", "[", "qb", "]"}]}]]}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Note", " ", "we", " ", "redefine", " ", "ang1"}], " ", 
      "\[Rule]", " ", 
      RowBox[{"ang", " ", "here"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "rewriting", " ", "terms", " ", "that", " ", "can", " ", "cause", " ", 
       RowBox[{"difficulties", ".", " ", "We"}], " ", "define", " ", "the", 
       " ", "angle", " ", "in", " ", 
       RowBox[{"\[Mu]", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", "in", " ", "terms", " ", "of"}], 
      " ", "|", 
      RowBox[{"x", "+", "y"}], "|", " ", "or", " ", "|", 
      RowBox[{"x", "-", "y"}], "|"}], ",", " ", 
     RowBox[{
      RowBox[{"whichever", " ", "is", " ", "more", " ", 
       RowBox[{"convenient", ".", " ", "Our"}], " ", "aim", " ", "is", " ", 
       "to", " ", "rewrite", " ", "each", " ", "term", " ", "as", " ", "a", 
       " ", "product", " ", "of", " ", "only", " ", "two"}], " ", "|", 
      RowBox[{
       SubscriptBox["k", "i"], "+", 
       RowBox[{"-", "q"}]}], "|", " ", "factors"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"NB", ":", " ", 
     RowBox[{"we", " ", "drop", " ", "terms", " ", "containing", " ", 
      RowBox[{
       RowBox[{"\[Eta]", "[", "0", "]"}], "/", 
       RowBox[{"mag", "[", "0", "]"}]}]}], ":", " ", 
     RowBox[{
     "these", " ", "are", " ", "all", " ", "proportional", " ", "to", " ", 
      SubscriptBox["G", "2"], 
      RowBox[{"(", 
       RowBox[{"q", ",", 
        RowBox[{"-", "q"}]}], ")"}], " ", "which", " ", "vanishes"}]}], " ", 
    "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"NB", ":", " ", 
     RowBox[{
     "we", " ", "only", " ", "need", " ", "terms", " ", "up", " ", "to", " ", 
      
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"q", ".", "z"}], ")"}], "2"], " ", "here"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ker411init", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ker411raw", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Eta]", "[", 
                    RowBox[{"-", "x_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"-", 
                    RowBox[{"\[Eta]", "[", "x", "]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"\[Eta]", "[", "0", "]"}], "\[Rule]", "0"}]}], 
                    "}"}]}], "/.", "muSubsExt"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"y_", "+", "x_"}]}], "]"}], "\[RuleDelayed]", " ", 
                    RowBox[{"\[Mu]M", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "+", "x"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{
                    RowBox[{"x_", "+", "y_"}], ",", "x_"}], "]"}], 
                    "\[RuleDelayed]", " ", 
                    RowBox[{"\[Mu]M", "[", 
                    RowBox[{
                    RowBox[{"x", "+", "y"}], ",", "x"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{
                    RowBox[{"y_", "-", "x_"}], ",", "x_"}], "]"}], 
                    "\[RuleDelayed]", " ", 
                    RowBox[{"\[Mu]P", "[", 
                    RowBox[{
                    RowBox[{"y", "-", "x"}], ",", "x"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"x_", ",", 
                    RowBox[{"y_", "-", "x_"}]}], "]"}], "\[RuleDelayed]", " ", 
                    RowBox[{"\[Mu]P", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"y", "-", "x"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{
                    RowBox[{"x_", "+", "y_"}], ",", 
                    RowBox[{"x_", "+", "z_"}]}], "]"}], "\[RuleDelayed]", " ", 
                    RowBox[{"\[Mu]M", "[", 
                    RowBox[{
                    RowBox[{"x", "+", "y"}], ",", 
                    RowBox[{"x", "+", "z"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"\[Mu]P", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}], ")"}], "/.", 
                
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Mu]P", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                   RowBox[{"angPlus", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"\[Mu]M", "[", 
                    RowBox[{"x_", ",", "y_"}], "]"}], "\[RuleDelayed]", 
                   RowBox[{"angMinus", "[", 
                    RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}], ")"}], "/.", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"al", "\[Rule]", "alfm"}], ",", 
                RowBox[{"be", "\[Rule]", "befm"}]}], "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"mag", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
              RowBox[{
               RowBox[{"mag", "[", 
                RowBox[{"-", "q"}], "]"}], "\[Rule]", 
               RowBox[{"mag", "[", "q", "]"}]}]}], "}"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{
               RowBox[{"-", "k1"}], "-", "k2"}], "]"}], "\[Rule]", "k3"}], 
            ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{
               RowBox[{"-", "k1"}], "-", "q"}], "]"}], "\[Rule]", "k1pq"}], 
            ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{
               RowBox[{"-", "k2"}], "-", "q"}], "]"}], "\[Rule]", "k2pq"}], 
            ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{
               RowBox[{"-", "k2"}], "+", "q"}], "]"}], "\[Rule]", "k2mq"}], 
            ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k1", "+", "k2"}], "]"}], "\[Rule]", "k3"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{
               RowBox[{"-", "k1"}], "+", "q"}], "]"}], "\[Rule]", "k1mq"}], 
            ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k1", "+", "k2", "+", "q"}], "]"}], "\[Rule]", "k3mq"}],
             ",", 
            RowBox[{
             RowBox[{"mag", "[", 
              RowBox[{"k1", "+", "k2", "-", "q"}], "]"}], "\[Rule]", 
             "k3pq"}]}], "}"}]}], "//", "Expand"}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           SuperscriptBox["k1mq", "2"], 
           SuperscriptBox["k1pq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           SuperscriptBox["k1mq", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1mq", "2"]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2mq", "2"], 
           SuperscriptBox["k2pq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           SuperscriptBox["k2mq", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2mq", "2"]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3mq", "2"], 
           SuperscriptBox["k3pq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           SuperscriptBox["k3mq", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3mq", "2"]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k1pq", "2"], "/", 
           SuperscriptBox["k1mq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k1mq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2pq", "2"], "/", 
           SuperscriptBox["k2mq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k2mq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3pq", "2"], "/", 
           SuperscriptBox["k3mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3mq", "2"]}], ")"}], "/", " ", 
           SuperscriptBox["k3mq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k1mq", "2"], "/", 
           SuperscriptBox["k1pq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k1pq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2mq", "2"], "/", 
           SuperscriptBox["k2pq", "2"]}], "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k2pq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3mq", "2"], "/", 
           SuperscriptBox["k3pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3pq", "2"]}], ")"}], "/", " ", 
           SuperscriptBox["k3pq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k1mq", "2"], "/", 
           SuperscriptBox["k3mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k3mq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k1mq", "2"], "/", 
           SuperscriptBox["k2mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k2mq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2mq", "2"], "/", 
           SuperscriptBox["k3mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k3mq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2mq", "2"], "/", 
           SuperscriptBox["k1mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k1mq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3mq", "2"], "/", 
           SuperscriptBox["k1mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k1mq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3mq", "2"], "/", 
           SuperscriptBox["k2mq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3pq", "2"]}], ")"}], "/", 
           SuperscriptBox["k2mq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k1pq", "2"], "/", 
           SuperscriptBox["k3pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k3pq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k1pq", "2"], "/", 
           SuperscriptBox["k2pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k1", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k1mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k2pq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2pq", "2"], "/", 
           SuperscriptBox["k3pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k3pq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k2pq", "2"], "/", 
           SuperscriptBox["k1pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k2", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k2mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k1pq", "2"]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3pq", "2"], "/", 
           SuperscriptBox["k1pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k1pq", "2"]}]}], ",", 
         RowBox[{
          RowBox[{
           SuperscriptBox["k3pq", "2"], "/", 
           SuperscriptBox["k2pq", "2"]}], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["k3", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["q", "2"]}], "-", 
             SuperscriptBox["k3mq", "2"]}], ")"}], "/", 
           SuperscriptBox["k2pq", "2"]}]}]}], "}"}]}], "//", "Expand"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.855166046502314*^9, 3.8551660492496853`*^9}, {
   3.8557641310855503`*^9, 3.855764132061494*^9}, 3.855765574308167*^9, {
   3.858422972238805*^9, 3.858422975981082*^9}, {3.858449264118062*^9, 
   3.85844926461163*^9}, {3.85957793679912*^9, 3.859577971030946*^9}, {
   3.8617128147383413`*^9, 3.8617128268608837`*^9}, {3.861714693583346*^9, 
   3.861714711993067*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"f445a5e4-095b-48f9-bb03-fc93544d8ff1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<tab411derivs-flat.wdx\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Load", " ", "kernels", " ", "from", " ", "disk"}], ",", " ", 
      RowBox[{"if", " ", "already", " ", "computed"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Loading pre-computed kernels\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Tab411", "=", 
      RowBox[{"Import", "[", "\"\<tab411-flat.wdx\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab411freq", " ", "=", " ", 
      RowBox[{"Import", "[", "\"\<tab411freq-flat.wdx\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab411derivs", "=", 
      RowBox[{"Import", "[", "\"\<tab411derivs-flat.wdx\>\"", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"(*", " ", 
     RowBox[{"Else", ",", " ", 
      RowBox[{"compute", " ", "from", " ", "scratch"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Starting \!\(\*SubscriptBox[\(B\), \(411\)]\) kernel \
computation...\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Rewrite", " ", "any", " ", "remaining", " ", "terms", " ", "with", " ",
        "three", " ", "angular", " ", "pieces"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Evaluating symmetries\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ker411", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ker411init", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{
           FractionBox["k1pq", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker411init", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{
           FractionBox["k1mq", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker411init", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "k1mq"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"p3", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{
           FractionBox["k2pq", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker411init", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "k2pq"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"p4", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{
           FractionBox["k2mq", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker411init", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"p5", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{
           FractionBox["k3pq", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker411init", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "k3pq"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"p6", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{
           FractionBox["k3mq", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]], 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "ker411init", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", "k3mq"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "p1", "]"}], "+", 
            RowBox[{"Abs", "[", "p2", "]"}], "+", 
            RowBox[{"Abs", "[", "p3", "]"}], "+", 
            RowBox[{"Abs", "[", "p4", "]"}], "+", 
            RowBox[{"Abs", "[", "p5", "]"}], "+", 
            RowBox[{"Abs", "[", "p6", "]"}]}], "\[LessEqual]", " ", "2"}], 
          ",", 
          RowBox[{
           RowBox[{"ker411", "+=", " ", 
            RowBox[{
            "ker411init", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], ";", 
           RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldTerm", "=", 
         RowBox[{
         "ker411init", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Define", " ", "angle", " ", "substitutions", " ", "to", " ", 
          "reduce", " ", "three", " ", "different", " ", "angles", " ", "to", 
          " ", "only", " ", "two"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"subs", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p1", ">", "0"}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k2pq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k3pq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  RowBox[{"3", 
                   SuperscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1pq", "\[Rule]", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k2pq", "2"], "-", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k3mq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1pq", "\[Rule]", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k2", "2"]}], "+", 
                  SuperscriptBox["k2mq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k3pq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k2mq", "2"], "-", " ", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["k3mq", "2"], "-", 
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p2", ">", "0"}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k2", "2"]}], "+", 
                  SuperscriptBox["k2pq", "2"], "-", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k3pq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k2", "2"]}], "+", 
                  SuperscriptBox["k2pq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k3mq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k2mq", "2"], "-", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k3pq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k1mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k2mq", "2"]}], "+", " ", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k3mq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  RowBox[{"3", 
                   SuperscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p3", ">", "0"}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k3pq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k1pq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  RowBox[{"3", 
                   SuperscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k3pq", "2"], "-", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["k1mq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k3", "2"]}], "+", 
                  SuperscriptBox["k3mq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k1pq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k3mq", "2"], "-", " ", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["k1mq", "2"], "-", 
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p4", ">", "0"}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2mq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k3", "2"]}], "+", 
                  SuperscriptBox["k3pq", "2"], "-", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["k1pq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p5", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k3", "2"]}], "+", 
                  SuperscriptBox["k3pq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k1mq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k3mq", "2"], "-", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["k1pq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p6", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k2mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k3mq", "2"]}], "+", " ", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k1mq", "2"], "+", 
                  SuperscriptBox["k1", "2"], "+", 
                  RowBox[{"3", 
                   SuperscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p5", ">", "0"}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k1pq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k2pq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  RowBox[{"3", 
                   SuperscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k1pq", "2"], "-", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["k2mq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k1", "2"]}], "+", 
                  SuperscriptBox["k1mq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k2pq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3pq", "\[Rule]", " ", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k1mq", "2"], "-", " ", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["k2mq", "2"], "-", 
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"p6", ">", "0"}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", " ", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k1", "2"]}], "+", 
                  SuperscriptBox["k1pq", "2"], "-", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["k2pq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p1", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k1", "2"]}], "+", 
                  SuperscriptBox["k1pq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "-", 
                  SuperscriptBox["k2mq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p3", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  SuperscriptBox["k1", "2"], "-", 
                  SuperscriptBox["k1mq", "2"], "-", 
                  SuperscriptBox["k2", "2"], "+", 
                  SuperscriptBox["k2pq", "2"], "+", 
                  SuperscriptBox["k3", "2"], "+", 
                  SuperscriptBox["q", "2"]}], "]"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p2", "\[NotEqual]", "0"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"p4", "\[NotEqual]", "0"}], ")"}]}], ",", 
             RowBox[{"subs", "=", 
              RowBox[{"{", 
               RowBox[{"k3mq", "\[Rule]", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   SuperscriptBox["k1mq", "2"]}], "+", " ", 
                  SuperscriptBox["k1", "2"], "+", 
                  SuperscriptBox["k3", "2"], "-", 
                  SuperscriptBox["k2mq", "2"], "+", 
                  SuperscriptBox["k2", "2"], "+", 
                  RowBox[{"3", 
                   SuperscriptBox["q", "2"]}]}], "]"}]}], "}"}]}]}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Substitutions", " ", "for", " ", "if", " ", "both"}], " ", 
          "|", 
          RowBox[{
           SubscriptBox["k", "i"], "+", "q"}], "|", " ", "and", " ", "|", 
          RowBox[{
           SubscriptBox["k", "i"], "-", "q"}], "|", " ", 
          RowBox[{"are", " ", "present"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Abs", "[", "p1", "]"}], "+", 
             RowBox[{"Abs", "[", "p2", "]"}]}], ")"}], "\[Equal]", "2"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p1", ">", "0"}], ",", 
            RowBox[{"subs", "=", 
             RowBox[{"{", 
              RowBox[{"k1pq", "\[Rule]", 
               RowBox[{"Sqrt", "[", " ", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["k1", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q", "2"]}], "-", 
                 SuperscriptBox["k1mq", "2"]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"subs", "=", 
             RowBox[{"{", 
              RowBox[{"k1mq", "\[Rule]", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["k1", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q", "2"]}], "-", 
                 SuperscriptBox["k1pq", "2"]}], "]"}]}], "}"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Abs", "[", "p3", "]"}], "+", 
             RowBox[{"Abs", "[", "p4", "]"}]}], ")"}], "\[Equal]", "2"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p3", ">", "0"}], ",", 
            RowBox[{"subs", "=", 
             RowBox[{"{", 
              RowBox[{"k2pq", "\[Rule]", 
               RowBox[{"Sqrt", "[", " ", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["k2", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q", "2"]}], "-", 
                 SuperscriptBox["k2mq", "2"]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"subs", "=", 
             RowBox[{"{", 
              RowBox[{"k2mq", "\[Rule]", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["k2", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q", "2"]}], "-", 
                 SuperscriptBox["k2pq", "2"]}], "]"}]}], "}"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Abs", "[", "p5", "]"}], "+", 
             RowBox[{"Abs", "[", "p6", "]"}]}], ")"}], "\[Equal]", "2"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p5", ">", "0"}], ",", 
            RowBox[{"subs", "=", 
             RowBox[{"{", 
              RowBox[{"k3pq", "\[Rule]", 
               RowBox[{"Sqrt", "[", " ", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["k3", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q", "2"]}], "-", 
                 SuperscriptBox["k3mq", "2"]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"subs", "=", 
             RowBox[{"{", 
              RowBox[{"k3mq", "\[Rule]", 
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"2", 
                  SuperscriptBox["k3", "2"]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["q", "2"]}], "-", 
                 SuperscriptBox["k3pq", "2"]}], "]"}]}], "}"}]}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "subs", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no conditions met!\>\"", "]"}], ";", 
           " ", 
           RowBox[{"Print", "[", 
            RowBox[{
            "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}], 
            "]"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "oldTerm", "]"}], "\[Equal]", 
           RowBox[{"Length", "[", "newTerm", "]"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<No substitutions made!\>\"", "]"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newTerm", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"oldTerm", "/.", "subs"}], ")"}], "//", "Expand"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ker411", "+=", "newTerm"}], " ", ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"List", " ", "of", " ", 
        SuperscriptBox[
         RowBox[{"\[Eta]", "[", "q", "]"}], "n"], " ", "substitutions"}], ",",
        " ", 
       RowBox[{
       "with", " ", "various", " ", "permutations", " ", "of", " ", "k1"}], 
       ",", " ", "k2", ",", " ", "k3"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Performing angular substitutions\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"NB", ":", " ", 
        RowBox[{
        "some", " ", "of", " ", "these", " ", "are", " ", "degenerate", " ", 
         "for", " ", "flat", " ", "conditions"}]}], ",", " ", 
       RowBox[{
       "but", " ", "easier", " ", "to", " ", "leave", " ", "them", " ", 
        RowBox[{"in", "!"}]}]}], " ", "*)"}], "\n", 
     RowBox[{"muSubs2", "=", 
      RowBox[{"muSubs", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"-", "2"}], ";;"}], "]"}], "]"}]}], ";", 
     RowBox[{"muSubs2p1m2", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angPlus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2p1m3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angPlus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "-", "q"}], "]"}], "\[Rule]", "k3mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2p1p2", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angPlus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2p1p3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angPlus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "+", "q"}], "]"}], "\[Rule]", "k3pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2m1m2", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angMinus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2m1m3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angMinus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "-", "q"}], "]"}], "\[Rule]", "k3mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2m1p2", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angMinus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2m1p3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angMinus", "[", 
            RowBox[{"k1", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]1"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "+", "q"}], "]"}], "\[Rule]", "k3pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2p2m3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angPlus", "[", 
            RowBox[{"k2", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]2"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "-", "q"}], "]"}], "\[Rule]", "k3mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2p2p3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angPlus", "[", 
            RowBox[{"k2", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]2"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "+", "q"}], "]"}], "\[Rule]", "k3pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2m2m3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angMinus", "[", 
            RowBox[{"k2", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]2"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "-", "q"}], "]"}], "\[Rule]", "k3mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"muSubs2m2p3", "=", 
      RowBox[{
       RowBox[{"muSubs2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ang1", "[", 
            RowBox[{"k1", ",", "q"}], "]"}], "\[Rule]", 
           RowBox[{"angMinus", "[", 
            RowBox[{"k2", ",", "q"}], "]"}]}], ",", 
          RowBox[{"\[Mu]1", "\[Rule]", "\[Mu]2"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"k3", "+", "q"}], "]"}], "\[Rule]", "k3pq"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "First", " ", "add", " ", "piece", " ", "independent", " ", "of", " ", 
       RowBox[{"\[Eta]", "[", "q", "]"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ker411v2", "=", 
      RowBox[{"ker411", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Eta]", "[", "q", "]"}], "\[Rule]", "0"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ker411mu", "=", 
      RowBox[{"(", 
       RowBox[{"ker411", "-", "ker411v2"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Now", " ", "add", " ", "other", " ", "pieces"}], ",", " ", 
       RowBox[{"substituting", " ", "for", " ", 
        RowBox[{"\[Eta]", "[", "q", "]"}]}]}], " ", "*)"}], "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ker411mu", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k1pq", 
             RowBox[{
             "ker411mu", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411mu", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k1mq", 
             RowBox[{
             "ker411mu", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411mu", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k1mq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p3", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k2pq", 
             RowBox[{
             "ker411mu", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411mu", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k2pq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p4", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k2mq", 
             RowBox[{
             "ker411mu", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411mu", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p5", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k3pq", 
             RowBox[{
             "ker411mu", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411mu", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k3pq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p6", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k3mq", 
             RowBox[{
             "ker411mu", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411mu", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k3mq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"thisSubs", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], ">",
            "2"}], ",", 
          RowBox[{"Print", "[", "\"\<SUBSTITUTIONS FAILED!\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "use", " ", "relevant", " ", "angular", " ", "substitutions", " ", 
          "in", " ", "each", " ", "case"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], 
           "\[Equal]", "0"}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p1m2"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], 
           "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p1", "\[Equal]", "1"}], ",", 
             RowBox[{"thisSubs", "=", "muSubs2p1m2"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p2", "\[Equal]", "1"}], ",", 
             RowBox[{"thisSubs", "=", "muSubs2m1m2"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p3", "\[Equal]", "1"}], ",", 
             RowBox[{"thisSubs", "=", "muSubs2p1p2"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p4", "\[Equal]", "1"}], ",", 
             RowBox[{"thisSubs", "=", "muSubs2p1m2"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p5", "\[Equal]", "1"}], ",", 
             RowBox[{"thisSubs", "=", "muSubs2p1p3"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"p6", "\[Equal]", "1"}], ",", 
             RowBox[{"thisSubs", "=", "muSubs2p1m3"}]}], "]"}], ";"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p1p2"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p1m2"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p1p3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p1m3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2m1p2"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2m1m2"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2m1p3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2m1m3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p2p3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2p2m3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2m2p3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"thisSubs", "=", "muSubs2m2m3"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"thisSubs", "\[Equal]", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"Print", "[", "\"\<SUBSTITUTIONS FAILED!\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"Print", "[", "\"\<SUBSTITUTIONS FAILED!\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", "1"}], ")"}]}], ",", 
          RowBox[{"Print", "[", "\"\<SUBSTITUTIONS FAILED!\>\"", "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ker411v2", "+=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"ker411mu", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "thisSubs"}], "//", 
           "Expand"}], ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Adding permutation symmetries\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ker411v3", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ker411v2", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"subs", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p1", "=", 
         RowBox[{
          FractionBox["k1pq", 
           RowBox[{
           "ker411v2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{
          FractionBox["k1mq", 
           RowBox[{
           "ker411v2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k1mq"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p3", "=", 
         RowBox[{
          FractionBox["k2pq", 
           RowBox[{
           "ker411v2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k2pq"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p4", "=", 
         RowBox[{
          FractionBox["k2mq", 
           RowBox[{
           "ker411v2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p5", "=", 
         RowBox[{
          FractionBox["k3pq", 
           RowBox[{
           "ker411v2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k3pq"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p6", "=", 
         RowBox[{
          FractionBox["k3mq", 
           RowBox[{
           "ker411v2", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v2", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k3mq"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[GreaterEqual]", " ", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k1pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k1", "2"]}], "+", 
                RowBox[{"2", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k1mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k2pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k2", "2"]}], "+", 
                RowBox[{"2", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k2mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p5", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k3pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k3", "2"]}], "+", 
                RowBox[{"2", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k3mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p2", ">=", "2"}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k1mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k1", "2"]}], "+", 
                RowBox[{"2", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k1pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", ">=", "2"}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k2mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k2", "2"]}], "+", 
                RowBox[{"2", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k2pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", ">=", "2"}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k3mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k3", "2"]}], "+", 
                RowBox[{"2", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k3pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k1mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k1", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k1pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k1mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k1", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k1pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p4", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p6", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k2mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k2", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k2pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p4", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k2mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k2", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k2pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p6", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p2", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k3mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k3", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k3pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p6", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p4", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k3mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k3", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k3pq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k1pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k1", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k1mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p1", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k1pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k1", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k1mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p5", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k2pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k2", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k2mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p3", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k2pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k2", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k2mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p5", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p1", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k3pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k3", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k3mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p5", ">=", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"p3", "\[Equal]", 
             RowBox[{"-", "2"}]}], ")"}]}], ",", 
          RowBox[{"subs", "=", 
           RowBox[{"{", 
            RowBox[{"k3pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["k3", "2"]}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["q", "2"]}], "-", 
                SuperscriptBox["k3mq", "2"]}], ")"}], "]"}]}], "}"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ker411v3", "+=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ker411v2", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/.", "subs"}], ")"}], "//", 
           "Expand"}], ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "All", " ", "terms", " ", "for", " ", "which", " ", "2", " ", "or", 
        " ", "3", " ", "of", " ", "\[Nu]1"}], ",", " ", 
       RowBox[{
       "\[Nu]2", " ", "and", " ", "\[Nu]3", " ", "are", " ", "negative", " ", 
        "integers", " ", "or", " ", "0"}], ",", " ", 
       RowBox[{
       "are", " ", "set", " ", "to", " ", "0.", " ", "This", " ", "is", " ", 
        "because", " ", "of", " ", "the", " ", "gamma", " ", "functions"}], 
       ",", " ", 
       RowBox[{"which", " ", "are", " ", "zero", " ", "in", " ", "these", " ", 
        RowBox[{"regimes", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ker411step1", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ker411v3", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"br1", "=", "0"}], ";", 
        RowBox[{"br2", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["k1pq", 
           RowBox[{
           "ker411v3", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "\[Equal]", "0"}], ",", 
          RowBox[{"br1", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"br2", "++"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["k1mq", 
           RowBox[{
           "ker411v3", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k1mq"}], "]"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "\[Equal]", "0"}], ",", 
          RowBox[{"br1", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"br2", "++"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["k2pq", 
           RowBox[{
           "ker411v3", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k2pq"}], "]"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "\[Equal]", "0"}], ",", 
          RowBox[{"br1", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"br2", "++"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["k2mq", 
           RowBox[{
           "ker411v3", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "\[Equal]", "0"}], ",", 
          RowBox[{"br1", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"br2", "++"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["k3pq", 
           RowBox[{
           "ker411v3", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k3pq"}], "]"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "\[Equal]", "0"}], ",", 
          RowBox[{"br1", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"br2", "++"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          FractionBox["k3mq", 
           RowBox[{
           "ker411v3", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]], 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", "k3mq"}], "]"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"p", "\[Equal]", "0"}], ",", 
          RowBox[{"br1", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"p", ">", "0"}], ",", 
            RowBox[{"br2", "++"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"br1", "+", "br2", "-", "4"}], "<", "2"}], ",", 
          RowBox[{"ker411step1", "=", 
           RowBox[{"ker411step1", "+", 
            RowBox[{
            "ker411v3", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"By", " ", "q"}], "\[Rule]", 
        RowBox[{"-", "q"}]}], ",", " ", 
       RowBox[{"12", "=", "21"}], ",", " ", 
       RowBox[{"13", "=", "31"}], ",", " ", 
       RowBox[{"23", "=", "32."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ker411part12", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ker411part13", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ker411part23", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "ker411step1", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k1pq", 
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k1mq", 
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k1mq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p3", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k2pq", 
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k2pq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p4", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k2mq", 
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p5", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k3pq", 
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k3pq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p6", "=", 
         RowBox[{"Abs", "[", 
          RowBox[{"Sign", "[", 
           RowBox[{
            FractionBox["k3mq", 
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k3mq"}], "]"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], ">",
            "2"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "i", ",", "\"\< \>\"", ",", "p1", ",", "p2", ",", "p3", ",", "p4",
              ",", "p5", ",", "p6", ",", 
             RowBox[{"ker411step1", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], 
            "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p1", "+", "p2"}], "\[Equal]", "1"}]}], ",", 
          RowBox[{"ker411part12", "=", 
           RowBox[{"ker411part12", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k1mq", "\[Rule]", "k1pq"}], ",", 
                RowBox[{"k2pq", "\[Rule]", "k2mq"}], ",", 
                RowBox[{"k3pq", "\[Rule]", "k3mq"}]}], "}"}]}], ")"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], 
            "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p3", "+", "p4"}], "\[Equal]", "1"}]}], ",", 
          RowBox[{"ker411part12", "=", 
           RowBox[{"ker411part12", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k1mq", "\[Rule]", "k1pq"}], ",", 
                RowBox[{"k2pq", "\[Rule]", "k2mq"}], ",", 
                RowBox[{"k3pq", "\[Rule]", "k3mq"}]}], "}"}]}], ")"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], 
            "\[Equal]", "1"}], "&&", 
           RowBox[{
            RowBox[{"p5", "+", "p6"}], "\[Equal]", "1"}]}], ",", 
          RowBox[{"ker411part13", "=", 
           RowBox[{"ker411part13", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "ker411step1", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"k1mq", "\[Rule]", "k1pq"}], ",", 
                RowBox[{"k2pq", "\[Rule]", "k2mq"}], ",", 
                RowBox[{"k3pq", "\[Rule]", "k3mq"}]}], "}"}]}], ")"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p1", "+", "p4"}], "\[Equal]", "2"}], ",", 
          RowBox[{"ker411part12", "+=", 
           RowBox[{
           "ker411step1", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p2", "+", "p3"}], "\[Equal]", "2"}], ",", 
          RowBox[{"ker411part12", "+=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"k1mq", "\[Rule]", "k1pq"}], ",", 
               RowBox[{"k2pq", "\[Rule]", "k2mq"}]}], "}"}]}], ")"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p1", "+", "p6"}], "\[Equal]", "2"}], ",", 
          RowBox[{"ker411part13", "+=", 
           RowBox[{
           "ker411step1", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p2", "+", "p5"}], "\[Equal]", "2"}], ",", 
          RowBox[{"ker411part13", "+=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"k1mq", "\[Rule]", "k1pq"}], ",", 
               RowBox[{"k3pq", "\[Rule]", "k3mq"}]}], "}"}]}], ")"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p3", "+", "p6"}], "\[Equal]", "2"}], ",", 
          RowBox[{"ker411part23", "+=", 
           RowBox[{
           "ker411step1", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p4", "+", "p5"}], "\[Equal]", "2"}], ",", 
          RowBox[{"ker411part23", "+=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "ker411step1", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"k2mq", "\[Rule]", "k2pq"}], ",", 
               RowBox[{"k3pq", "\[Rule]", "k3mq"}]}], "}"}]}], ")"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "p1", "+", "p2", "+", "p3", "+", "p4", "+", "p5", "+", "p6"}], 
             "\[Equal]", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p1", "+", "p4"}], "\[NotEqual]", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p1", "+", "p6"}], "\[NotEqual]", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p3", "+", "p6"}], "\[NotEqual]", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "+", "p3"}], "\[NotEqual]", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p2", "+", "p5"}], "\[NotEqual]", "2"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p4", "+", "p5"}], "\[NotEqual]", "2"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<ERR\>\"", "]"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{
            "p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}], 
            "]"}], ";", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ker411final", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["q", "\[Nu]"], "ker411part12"}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q", "\[Nu]"], "ker411part13"}], "//", 
              "Expand"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "k1mqt"}], ",", 
              RowBox[{"k1pq", "\[Rule]", "qt"}], ",", 
              RowBox[{"k3mq", "\[Rule]", "k2pqt"}]}], "}"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"qt", "\[Rule]", "q"}], ",", 
            RowBox[{"k1mqt", "\[Rule]", "k1pq"}], ",", 
            RowBox[{"k2pqt", "\[Rule]", "k2mq"}]}], "}"}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["q", "\[Nu]"], "ker411part23"}], "//", 
              "Expand"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "k2mqt"}], ",", 
              RowBox[{"k2pq", "\[Rule]", "qt"}], ",", 
              RowBox[{"k3mq", "\[Rule]", "k1pqt"}]}], "}"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"qt", "\[Rule]", "q"}], ",", 
            RowBox[{"k1pqt", "\[Rule]", "k1pq"}], ",", 
            RowBox[{"k2mqt", "\[Rule]", "k2mq"}]}], "}"}]}], ")"}]}], "//", 
       "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ker411final", "=", 
      RowBox[{
       RowBox[{"ker411final", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k1", "\[Rule]", "1"}], ",", 
          RowBox[{"k2", "\[Rule]", 
           SqrtBox["y"]}], ",", 
          RowBox[{"k3", "\[Rule]", 
           SqrtBox["x"]}]}], "}"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Tabulating output coefficients\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Construct", " ", "Output", " ", "Table"}], " ", "*)"}], 
     RowBox[{"Tab411step1", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            FractionBox["q", 
             RowBox[{
             "ker411final", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411final", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "q"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            FractionBox["k1pq", 
             RowBox[{
             "ker411final", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411final", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k1pq"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "2"]}], 
            FractionBox["k2mq", 
             RowBox[{
             "ker411final", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]], 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "ker411final", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", "k2mq"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
            "ker411final", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "\[Rule]", "1"}], ",", 
              RowBox[{"k1pq", "\[Rule]", "1"}], ",", 
              RowBox[{"k2mq", "\[Rule]", "1"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ker411final", "]"}]}], "}"}]}], "]"}], "//",
        "Expand"}]}], ";", 
     RowBox[{"minpow", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Tab411step1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", "3"}]}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Nu]", "\[Rule]", "0"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxpow", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"Tab411step1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", "3"}]}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"\[Nu]", "\[Rule]", "0"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pom", "=", "0"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "minpow"}], ",", 
       RowBox[{"i1", "\[LessEqual]", "maxpow"}], ",", 
       RowBox[{"i1", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "minpow"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxpow"}], ",", 
         RowBox[{"i2", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "minpow"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxpow"}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Tab411step1", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"i1", "-", 
                    FractionBox["\[Nu]", "2"]}], ",", "i2", ",", "i3", ",", 
                    "_"}], "}"}]}], "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{"pom", "=", 
               RowBox[{"pom", "+", "1"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Tab411step1", ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", 
                    RowBox[{"i2", "-", 
                    FractionBox["\[Nu]", "2"]}], ",", "i3", ",", "_"}], 
                   "}"}]}], "]"}], "]"}], ">", "0"}], ",", 
              RowBox[{"pom", "=", 
               RowBox[{"pom", "+", "1"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{"Tab411step1", ",", 
                  RowBox[{"{", 
                   RowBox[{"i1", ",", "i2", ",", 
                    RowBox[{"i3", "-", 
                    FractionBox["\[Nu]", "2"]}], ",", "_"}], "}"}]}], "]"}], 
                "]"}], ">", "0"}], ",", 
              RowBox[{"pom", "=", 
               RowBox[{"pom", "+", "1"}]}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Preparing output table\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tab411", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "pom"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"counter", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i1", "=", "minpow"}], ",", 
       RowBox[{"i1", "\[LessEqual]", "maxpow"}], ",", 
       RowBox[{"i1", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i2", "=", "minpow"}], ",", 
         RowBox[{"i2", "\[LessEqual]", "maxpow"}], ",", 
         RowBox[{"i2", "++"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i3", "=", "minpow"}], ",", 
           RowBox[{"i3", "\[LessEqual]", "maxpow"}], ",", 
           RowBox[{"i3", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pom", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"Tab411step1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"i1", "-", 
                  FractionBox["\[Nu]", "2"]}], ",", "i2", ",", "i3", ",", 
                 "_"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pom", "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Tab411", "\[LeftDoubleBracket]", "counter", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"i1", "-", 
                   FractionBox["\[Nu]", "2"]}], ",", "i2", ",", "i3", ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"pom", " ", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
               RowBox[{"counter", "=", 
                RowBox[{"counter", "+", "1"}]}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pom", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"Tab411step1", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", 
                 RowBox[{"i2", "-", 
                  FractionBox["\[Nu]", "2"]}], ",", "i3", ",", "_"}], "}"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pom", "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Tab411", "\[LeftDoubleBracket]", "counter", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", 
                  RowBox[{"i2", "-", 
                   FractionBox["\[Nu]", "2"]}], ",", "i3", ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
               RowBox[{"counter", "=", 
                RowBox[{"counter", "+", "1"}]}], ";"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"pom", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"Tab411step1", ",", 
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2", ",", 
                 RowBox[{"i3", "-", 
                  FractionBox["\[Nu]", "2"]}], ",", "_"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "pom", "]"}], ">", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Tab411", "\[LeftDoubleBracket]", "counter", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"i1", ",", "i2", ",", 
                  RowBox[{"i3", "-", 
                   FractionBox["\[Nu]", "2"]}], ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"pom", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "4"}], "\[RightDoubleBracket]"}], 
                    "]"}]}], "}"}]}], "]"}]}], "}"}]}], ";", 
               RowBox[{"counter", "=", 
                RowBox[{"counter", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Saving results\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Save", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SetDirectory", "[", "workdir", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab411-flat.wdx\>\"", ",", "Tab411"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Define", " ", "table", " ", "derivatives", " ", "and", " ", 
       "frequencies"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"biasZeros", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g21x", "\[Rule]", "0"}], ",", 
        RowBox[{"g211", "\[Rule]", "0"}], ",", 
        RowBox[{"g22", "\[Rule]", "0"}], ",", 
        RowBox[{"g31", "\[Rule]", "0"}], ",", 
        RowBox[{"g21", "\[Rule]", "0"}], ",", 
        RowBox[{"g3", "\[Rule]", "0"}], ",", 
        RowBox[{"b3", "\[Rule]", "0"}], ",", 
        RowBox[{"g2x", "\[Rule]", "0"}], ",", 
        RowBox[{"g2", "\[Rule]", "0"}], ",", 
        RowBox[{"b2", "\[Rule]", "0"}], ",", 
        RowBox[{"b1", "\[Rule]", "0"}], ",", 
        RowBox[{"f", "\[Rule]", "0"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Tab411derivs", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{
           RowBox[{"Tab411", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "4"}], "]"}], "]"}], ",", 
           RowBox[{"biasListB411", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "/.", "biasZeros"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "biasListB411", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab411derivs-flat.wdx\>\"", ",", "Tab411derivs"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Tab411freq", "=", 
      RowBox[{"Tab411", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{";;", "3"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<tab411freq-flat.wdx\>\"", ",", "Tab411freq"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Calculations complete\>\"", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.861712870831324*^9, 3.8617131403542557`*^9}, {
  3.861713187817337*^9, 3.861713215047102*^9}, {3.8617147459015627`*^9, 
  3.861714943440495*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"e3d51214-09ac-45b4-a8dd-20a0325b9f37"],

Cell[BoxData["\<\"Loading pre-computed kernels\"\>"], "Print",
 CellChangeTimes->{{3.8617131942963743`*^9, 3.861713215409945*^9}, 
   3.861714945475882*^9, 3.861715093453082*^9, 3.861715639936692*^9},
 CellLabel->
  "During evaluation of \
In[131]:=",ExpressionUUID->"b4972ff7-e1cb-42fa-964d-d4cd0a4e83ea"]
}, Open  ]],

Cell["\<\
Now extract coefficients. There are 70 choices in total (enumerated in \
\[OpenCurlyDoubleQuote]biasListB411\[CloseCurlyDoubleQuote]).\
\>", "Text",
 CellChangeTimes->{{3.861713236890078*^9, 
  3.8617132774838047`*^9}},ExpressionUUID->"f12bc05f-5453-4cdd-b763-\
e8ab9a356cf8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Extract", " ", "the", " ", "relevant", " ", "coefficients"}], 
    ",", " ", 
    RowBox[{"for", " ", 
     RowBox[{"example", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tab411g2xb1b1", " ", "=", " ", 
    RowBox[{"ExtractCoeff", "[", 
     RowBox[{"Tab411", ",", 
      RowBox[{"g2x", " ", 
       SuperscriptBox["b1", "2"]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tab411g211b1b1", " ", "=", " ", 
     RowBox[{"ExtractCoeff", "[", 
      RowBox[{"Tab411", ",", " ", 
       RowBox[{"g2", " ", 
        SuperscriptBox["b1", "2"]}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8540262009714603`*^9, 3.854026231689104*^9}, {
   3.8540270512182217`*^9, 3.8540270529257507`*^9}, {3.854055531333582*^9, 
   3.8540555584706993`*^9}, {3.854056719123336*^9, 3.854056735603179*^9}, {
   3.8542072452252703`*^9, 3.854207247029652*^9}, {3.8542100474909554`*^9, 
   3.8542101072301407`*^9}, {3.854210750353656*^9, 3.854210855086341*^9}, {
   3.854285872075206*^9, 3.854285883463423*^9}, {3.854286609334359*^9, 
   3.854286609957732*^9}, {3.85439743466149*^9, 3.854397435716956*^9}, {
   3.854484676222584*^9, 3.854484739250187*^9}, {3.854572307538651*^9, 
   3.8545723081912003`*^9}, 3.854615670877964*^9, {3.859284136788567*^9, 
   3.859284144937639*^9}, 3.861713221725267*^9},
 CellLabel->
  "In[118]:=",ExpressionUUID->"bd7aa7e4-fc81-47ee-9bbd-9c405e106758"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", "0", ",", "1", ",", 
     RowBox[{"-", 
      FractionBox["3", 
       RowBox[{"28", " ", "y"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", "1", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["3", "28"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", "0", ",", "1", ",", 
     RowBox[{
      FractionBox["3", "7"], "-", 
      FractionBox["3", 
       RowBox[{"28", " ", "y"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", "1", ",", "0", ",", 
     RowBox[{
      FractionBox["3", "7"], "-", 
      FractionBox[
       RowBox[{"3", " ", "y"}], "28"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]", "2"]}], ",", "0", ",", "1", ",", 
     RowBox[{
      FractionBox["3", "14"], "-", 
      FractionBox[
       RowBox[{"9", " ", "y"}], "14"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Nu]", "2"]}], ",", "1", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["9", "14"]}], "+", 
      FractionBox[
       RowBox[{"3", " ", "y"}], "14"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["3", 
       RowBox[{"28", " ", "y"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     FractionBox["3", "14"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", "y"}], "28"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", 
      FractionBox["3", 
       RowBox[{"28", " ", "y"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     FractionBox["3", "14"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     FractionBox["3", 
      RowBox[{"14", " ", "y"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", 
      FractionBox["3", "7"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     FractionBox[
      RowBox[{"3", " ", "y"}], "14"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     FractionBox["3", 
      RowBox[{"14", " ", "y"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["3", "7"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]", "2"]}], ",", "0", ",", "1", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", "y"}], "28"]}], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["y", "2"]}], "7"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", "2"}], ",", 
     RowBox[{"-", 
      FractionBox["3", 
       RowBox[{"28", " ", "y"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"1", "-", 
      FractionBox["\[Nu]", "2"]}], ",", 
     RowBox[{"-", "1"}], ",", 
     FractionBox["3", "14"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox["\[Nu]", "2"]}], ",", "1", ",", "0", ",", 
     RowBox[{
      FractionBox["3", "7"], "-", 
      FractionBox[
       RowBox[{"3", " ", "y"}], "28"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]", "2"]}], ",", "0", ",", "1", ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["y", "3"]}], "28"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "-", 
      FractionBox["\[Nu]", "2"]}], ",", "1", ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["3", "28"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.861713222537118*^9, 3.861715095789535*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"1fd01550-a546-4b56-a951-e88633f9f361"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Explicit UV limits", "Section",
 CellChangeTimes->{{3.85420756969024*^9, 3.8542075742583733`*^9}, 
   3.8542897361477747`*^9, {3.854386885256297*^9, 3.854386886331017*^9}, {
   3.855069988701877*^9, 3.8550699895421333`*^9}, {3.855235921574491*^9, 
   3.855235921712549*^9}},ExpressionUUID->"0c171b24-0a9d-4774-a6f5-\
74ec0c1f4b10"],

Cell[TextData[{
 "The UV limits below will be added onto the FFTLog result. We assume -1 < \
\[Nu] < -1/2 to set which terms are relevant here. Note that this contains \
only one permutation; we will add the symmetrizations later. Note that we can \
integrate with respect to internal ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"q", ".", 
     SubscriptBox["k", "1"]}]}], TraditionalForm]],ExpressionUUID->
  "12f98ff2-9a25-434f-9d44-33e65c481ddf"],
 ") angles as long as we first remove the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"q", ".", "z"}]}], TraditionalForm]],ExpressionUUID->
  "c360ba2d-873c-46fa-90eb-cfd0e74949cd"],
 ") dependence from the integral via the \[Eta][q] substitutions"
}], "Text",
 CellChangeTimes->{{3.854289737829587*^9, 3.8542897606443567`*^9}, {
  3.854386888942665*^9, 3.854386900424136*^9}, {3.854386959455268*^9, 
  3.854386961639471*^9}, {3.8544499350144777`*^9, 3.8544499352717447`*^9}, {
  3.854649041646421*^9, 3.854649046088043*^9}, {3.855167803037683*^9, 
  3.855167840408737*^9}},ExpressionUUID->"675f50e6-c17e-478a-a938-\
9d89f63f9d0a"],

Cell[CellGroupData[{

Cell["Set-Up", "Subsubsection",
 CellChangeTimes->{{3.861713574895068*^9, 
  3.861713575775037*^9}},ExpressionUUID->"ddde4e00-d213-431d-a13c-\
861d5a1a76ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "b1", ",", "b2", ",", "g2", ",", "b3", ",", "g2x", ",", "g3", ",", "g21", 
    ",", "g21x", ",", " ", "g211", ",", "g22", ",", " ", "g31", ",", "betaBa",
     ",", "betaBb", ",", "betaBb", ",", "betaBc", ",", "betaBd", ",", 
    "betaBe", ",", "eps0", ",", "eta0", ",", "eps2", ",", "eta21", ",", 
    "eta22", ",", "f", ",", "k1", ",", "k2", ",", "k3"}], "]"}], 
  ";"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"8a41f9fa-071f-46d3-940d-96497226e6f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Define", " ", "the", " ", "UV", " ", "limits", " ", "for", " ", "flat", 
     " ", "configurations"}], ",", " ", 
    RowBox[{
    "integrated", " ", "over", " ", "internal", " ", "q", " ", "angles"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"limFullUV", "[", 
    RowBox[{"kernel_", ",", "biases_", ",", "qpower_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"intA", ",", "intB", ",", "intC", ",", " ", "intD"}], "}"}], 
     ",", 
     RowBox[{
      RowBox[{"intA", "=", 
       RowBox[{"SeriesCoefficient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Coefficient", "[", 
                   RowBox[{"kernel", ",", "biases"}], "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"f", "\[Rule]", "0"}], ",", 
                    RowBox[{"b1", "\[Rule]", "0"}], ",", 
                    RowBox[{"b2", "\[Rule]", "0"}], ",", 
                    RowBox[{"g2", "\[Rule]", "0"}], ",", 
                    RowBox[{"g2x", "\[Rule]", "0"}], ",", 
                    RowBox[{"g3", "\[Rule]", "0"}], ",", 
                    RowBox[{"g21", "\[Rule]", "0"}], ",", 
                    RowBox[{"g21x", "\[Rule]", "0"}], ",", 
                    RowBox[{"g211", "\[Rule]", "0"}], ",", 
                    RowBox[{"g22", "\[Rule]", "0"}], ",", 
                    RowBox[{"g31", "\[Rule]", "0"}]}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"k1", ",", 
                    RowBox[{"k2", "-", "q"}]}], "]"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    FractionBox["k2", "k2mq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "k2"}], "]"}]}], "-", 
                    RowBox[{
                    FractionBox["q", "k2mq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "q"}], "]"}]}]}]}], ",", 
                   RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"k2", ",", 
                    RowBox[{"k1", "-", "q"}]}], "]"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{
                    FractionBox["k1", "k1mq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k2", ",", "k1"}], "]"}]}], "-", 
                    RowBox[{
                    FractionBox["q", "k1mq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k2", ",", "q"}], "]"}]}]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"k1", ",", 
                    RowBox[{"k2", "+", "q"}]}], "]"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{
                    FractionBox["k2", "k2pq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "k2"}], "]"}]}], "+", 
                    RowBox[{
                    FractionBox["q", "k2pq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k1", ",", "q"}], "]"}]}]}]}], ",", 
                   RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"k2", ",", 
                    RowBox[{"k1", "+", "q"}]}], "]"}], "\[Rule]", " ", 
                    RowBox[{
                    RowBox[{
                    FractionBox["k1", "k1pq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k2", ",", "k1"}], "]"}]}], "+", 
                    RowBox[{
                    FractionBox["q", "k1pq"], 
                    RowBox[{"ang", "[", 
                    RowBox[{"k2", ",", "q"}], "]"}]}]}]}], ",", 
                   RowBox[{
                    RowBox[{"ang1", "[", 
                    RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"ang", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}]}], "}"}]}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"al", "\[Rule]", "alfm"}], ",", 
                  RowBox[{"be", "\[Rule]", "befm"}]}], "}"}]}], ")"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mag", "[", "q", "]"}], "\[Rule]", "q"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"-", "q"}], "]"}], "\[Rule]", "q"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", "k1", "]"}], "\[Rule]", "k1"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", "k2", "]"}], "\[Rule]", "k2"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k1", "+", "k2"}], "]"}], "\[Rule]", "k3"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k1", "+", "q"}], "]"}], "\[Rule]", "k1pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"-", "k1"}], "]"}], "\[Rule]", "k1"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"q", "-", "k3"}], "]"}], "\[Rule]", "k3mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], "+", "q"}], "]"}], "\[Rule]", 
                 "k1mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "q"}], "-", "k1"}], "]"}], "\[Rule]", 
                 "k1pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k2", "-", "q"}], "]"}], "\[Rule]", "k2mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], "-", "k3"}], "]"}], "\[Rule]", "k2"}],
                 ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"-", "k3"}], "]"}], "\[Rule]", "k3"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"q", "-", "k3"}], "]"}], "\[Rule]", "k3mq"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k1", "+", "k2", "-", "q"}], "]"}], "\[Rule]", 
                 "k3pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k2"}], "-", "k3", "+", "q"}], "]"}], 
                 "\[Rule]", "k1pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k2", "+", "q"}], "]"}], "\[Rule]", "k2pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"-", "k2"}], "]"}], "\[Rule]", "k2"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k2"}], "+", "q"}], "]"}], "\[Rule]", 
                 "k2mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k2"}], "-", "k3"}], "]"}], "\[Rule]", "k1"}],
                 ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k3"}], "-", "q"}], "]"}], "\[Rule]", 
                 "k3pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k3", "+", "q"}], "]"}], "\[Rule]", "k3pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k2", "+", "k3", "+", "q"}], "]"}], "\[Rule]", 
                 "k1mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", "k3", "]"}], "\[Rule]", "k3"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k2", "+", "k3"}], "]"}], "\[Rule]", "k1"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k2"}], "-", "q"}], "]"}], "\[Rule]", 
                 "k2pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], "-", "k2", "-", "q"}], "]"}], 
                 "\[Rule]", "k3mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k1", "-", "q"}], "]"}], "\[Rule]", "k1mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k1", "+", "k2", "+", "q"}], "]"}], "\[Rule]", 
                 "k3mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"k3", "-", "q"}], "]"}], "\[Rule]", "k3mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k2"}], "-", "k3", "-", "q"}], "]"}], 
                 "\[Rule]", "k1mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], "-", "k2", "+", "q"}], "]"}], 
                 "\[Rule]", "k3pq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], "-", "k3"}], "]"}], "\[Rule]", "k2"}],
                 ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{"q", "-", "k3"}], "]"}], "\[Rule]", "k3mq"}], ",", 
                RowBox[{
                 RowBox[{"mag", "[", 
                  RowBox[{
                   RowBox[{"-", "k1"}], "-", "k2"}], "]"}], "\[Rule]", 
                 "k3"}]}], "}"}]}], ")"}], ")"}], ")"}], " ", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"k1mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["k1", "2"], "+", 
               SuperscriptBox["q", "2"], "-", 
               RowBox[{"2", " ", "k1", " ", "q", " ", "\[Xi]1"}]}], "]"}]}], 
            ",", 
            RowBox[{"k1pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["k1", "2"], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "k1", " ", "q", " ", "\[Xi]1"}]}], "]"}]}], 
            ",", 
            RowBox[{"k2mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["k2", "2"], "+", 
               SuperscriptBox["q", "2"], "-", 
               RowBox[{"2", " ", "k2", " ", "q", " ", "\[Xi]2"}]}], "]"}]}], 
            ",", 
            RowBox[{"k2pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["k2", "2"], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "k2", " ", "q", " ", "\[Xi]2"}]}], "]"}]}], 
            ",", 
            RowBox[{"k3mq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["k3", "2"], "+", 
               SuperscriptBox["q", "2"], "-", 
               RowBox[{"2", " ", "k3", " ", "q", " ", "\[Xi]3"}]}], "]"}]}], 
            ",", 
            RowBox[{"k3pq", "\[Rule]", 
             RowBox[{"Sqrt", "[", 
              RowBox[{
               SuperscriptBox["k3", "2"], "+", 
               SuperscriptBox["q", "2"], "+", 
               RowBox[{"2", " ", "k3", " ", "q", " ", "\[Xi]3"}]}], "]"}]}]}],
            "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"q", ",", "\[Infinity]", ",", "qpower"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", 
       RowBox[{"cc", ",", "ss"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Rewrite", " ", "internal", " ", 
          RowBox[{"angles", ".", " ", "cc"}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"k1", ".", "k2"}], "/", "k1k2"}]}], ",", " ", 
        RowBox[{"ss", " ", "=", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           SuperscriptBox["cc", "2"]}], "]"}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"intB", "=", 
       RowBox[{
        RowBox[{"intA", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Xi]1", "\[Rule]", "\[Xi]"}], ",", 
           RowBox[{"\[Xi]2", "\[Rule]", 
            RowBox[{
             RowBox[{"\[Xi]", " ", "cc"}], "-", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Xi]", "2"]}], "]"}], "ss", " ", 
              RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], ",", 
           RowBox[{"\[Xi]3", "\[Rule]", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"-", "k1"}], "k3"], "\[Xi]"}], "-", 
             RowBox[{
              FractionBox["k2", "k3"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Xi]", " ", "cc"}], "-", 
                RowBox[{
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"1", "-", 
                   SuperscriptBox["\[Xi]", "2"]}], "]"}], "ss", " ", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}]}]}]}]}], 
          "}"}]}], "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Perform", " ", 
        RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", "integral", " ", "by", " ", 
        "hand", " ", "for", " ", "speed"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"intC", " ", "=", " ", 
       RowBox[{"intB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "8"], "\[Rule]", 
           "\[Infinity]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "7"], "\[Rule]", 
           "\[Infinity]"}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "6"], "\[Rule]", " ", 
           RowBox[{"5", "/", "16"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "5"], "\[Rule]", "0"}], ",", 
          
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "4"], "\[Rule]", " ", 
           RowBox[{"3", "/", "8"}]}], ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "3"], "\[Rule]", "0"}], ",", 
          
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], "\[Rule]", " ", 
           RowBox[{"1", "/", "2"}]}], ",", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Phi]", "]"}], "\[Rule]", "0"}]}], "}"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Perform", " ", "\[Mu]", " ", "integration"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"intD", "=", 
       RowBox[{
        RowBox[{"Integrate", "[", 
         RowBox[{"intC", ",", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", 
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], 
        FractionBox["1", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"intD", "/.", " ", 
           RowBox[{"{", 
            RowBox[{"ss", "\[Rule]", " ", 
             RowBox[{"Sqrt", "[", 
              RowBox[{"1", "-", 
               SuperscriptBox["cc", "2"]}], "]"}]}], "}"}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{"cc", "\[Rule]", " ", 
           FractionBox[
            RowBox[{
             SuperscriptBox["k3", "2"], "-", 
             SuperscriptBox["k1", "2"], "-", 
             SuperscriptBox["k2", "2"]}], 
            RowBox[{"2", " ", "k1", " ", "k2"}]]}], "}"}]}], ")"}], "//", 
       "FullSimplify"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.854207622053637*^9, 3.85420766837148*^9}, {
   3.854207720300563*^9, 3.8542077312975883`*^9}, {3.854208501855009*^9, 
   3.854208516377603*^9}, {3.8542088360766487`*^9, 3.854208840416299*^9}, {
   3.8542088921867237`*^9, 3.854208895582924*^9}, {3.8542091029583883`*^9, 
   3.854209106926023*^9}, {3.854209672695998*^9, 3.8542096977414*^9}, {
   3.854210999617293*^9, 3.8542110983205442`*^9}, {3.8542112111816998`*^9, 
   3.854211218736682*^9}, {3.854211250125278*^9, 3.854211385474152*^9}, {
   3.854211451112544*^9, 3.854211604868178*^9}, {3.854211653693548*^9, 
   3.854211714478359*^9}, {3.854211759803451*^9, 3.854211765824161*^9}, {
   3.8542877053621197`*^9, 3.854287708029235*^9}, {3.854289440764388*^9, 
   3.854289623115561*^9}, {3.8542899528840714`*^9, 3.854289954367712*^9}, {
   3.854316007738703*^9, 3.854316013775173*^9}, {3.8543160646138144`*^9, 
   3.8543160683779488`*^9}, 3.8543161337674427`*^9, {3.854386787165606*^9, 
   3.85438679337409*^9}, {3.8543868274219837`*^9, 3.8543868290731487`*^9}, {
   3.85438697965676*^9, 3.854386991188189*^9}, {3.8544590323538427`*^9, 
   3.854459038502698*^9}, {3.855166341259982*^9, 3.855166379125041*^9}, {
   3.8551672093646317`*^9, 3.855167217373248*^9}, {3.855167469955839*^9, 
   3.855167488218009*^9}, 3.855167844782241*^9, {3.855168049108802*^9, 
   3.85516805073671*^9}, {3.855168544710699*^9, 3.855168567134553*^9}, {
   3.855168602866538*^9, 3.855168622958776*^9}, {3.855684633270378*^9, 
   3.855684637090837*^9}, 3.855684947819406*^9, {3.855685196644558*^9, 
   3.855685199990464*^9}, {3.861713291447044*^9, 3.861713312657496*^9}, {
   3.861714970266061*^9, 3.861714980571643*^9}, {3.8617150669655323`*^9, 
   3.861715069622163*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"a710a6e8-5b5d-4785-9fd4-f419667949b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["B222", "Subsubsection",
 CellChangeTimes->{{3.854387012017116*^9, 
  3.85438701316428*^9}},ExpressionUUID->"a90a1da6-a4ce-43ab-8880-\
8874f359a0cd"],

Cell[TextData[{
 "Assuming -1 < \[Nu] < -1/2, we do *not* need to add any UV limits to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["B", "222"], TraditionalForm]],ExpressionUUID->
  "65c172d8-1f68-4482-b2d5-0c79ca06fadd"],
 ". Technically, terms with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["k", "0"], " ", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["P", "3"], "(", "q", ")"}], "d3q"}]}]}], 
   TraditionalForm]],ExpressionUUID->"37e9d6e5-73ad-4950-9500-9a319b0a62a6"],
 " from three ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Delta]", "2"], TraditionalForm]],ExpressionUUID->
  "d46e7596-2bc9-4c24-bbce-302b331b5855"],
 " operators are missed unless \[Nu]<-1; however, these are degenerate with \
shot-noise, and should be subtracted off in practice, just as for the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Delta]", "2"], TraditionalForm]],ExpressionUUID->
  "29df0259-d1ec-4260-97c5-71607b3e0b92"],
 " term in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "22"], TraditionalForm]],ExpressionUUID->
  "48a09382-4a01-4be0-84d8-7d1a49ae4c31"],
 ". This subtraction is done implicitly if \[Nu] > -1."
}], "Text",
 CellChangeTimes->{{3.854387025440011*^9, 3.854387055301158*^9}, {
  3.854387135482354*^9, 3.8543871490202827`*^9}, {3.854387233043147*^9, 
  3.854387336734617*^9}, {3.8544025871902857`*^9, 3.8544026285168877`*^9}, {
  3.854449943958106*^9, 3.854450016673152*^9}, {3.8546490517277107`*^9, 
  3.854649057138583*^9}, {3.85568529665631*^9, 
  3.85568529668748*^9}},ExpressionUUID->"4b331670-fd98-4c0c-9446-\
42e1db9fc7f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B222UVkernel", " ", "=", " ", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.8543871721629753`*^9, 3.8543871722233686`*^9}, {
  3.854450027106839*^9, 3.8544500272696953`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"2209cf69-d864-4329-bda0-e3ebfe0754d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["B321-I", "Subsubsection",
 CellChangeTimes->{{3.854387311828163*^9, 3.854387313048427*^9}, {
  3.85438736991413*^9, 
  3.854387371071414*^9}},ExpressionUUID->"0b3eb213-77cc-42c9-b5a8-\
b4c846c8b012"],

Cell[TextData[{
 "Assuming -1 < \[Nu] < -1/2, only terms involving two ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SuperscriptBox["\[Delta]", "2"]}], TraditionalForm]],ExpressionUUID->
  "d8576fac-368a-4a17-9f8a-ff965c13da34"],
 ", ",
 Cell[BoxData[
  FormBox["G2\[Delta]", TraditionalForm]],ExpressionUUID->
  "38dea442-8552-438a-a047-20fb84040157"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Delta]", "3"], TraditionalForm]],ExpressionUUID->
  "2a45edb4-a84d-4199-bcdd-22939ab531e4"],
 "} need the UV limits to be manually added (these are captured by FFTlog \
only if \[Nu] < -3/2). However, these parts are fully degenerate with the \
shot-noise, ",
 StyleBox["i.e.",
  FontSlant->"Italic"],
 " they scale as P(k) * const, and should be subtracted off in practice. For \
this reason, we do not include them below."
}], "Text",
 CellChangeTimes->{{3.854459285202855*^9, 3.8544594426558657`*^9}, {
  3.854649093795063*^9, 
  3.854649098352969*^9}},ExpressionUUID->"18427ac0-643e-461a-931c-\
b5fa2e36beba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B321IUVkernel", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.85946863935835*^9, 3.859468644209424*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"f6cc1764-0326-4c62-948f-537cb2c3c0a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["B411", "Subsubsection",
 CellChangeTimes->{{3.854387642305121*^9, 
  3.854387644106002*^9}},ExpressionUUID->"69b3dd7a-bfb4-4249-b7dc-\
3d3550faf291"],

Cell[TextData[{
 "Here, we require the UV limits from all terms, since all require \[Nu] < \
-1, which is violated here. Since \[Nu] > -3, we require no subleading UV \
divergences. Note that we require only the piece scaling as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["k", "2"], 
    RowBox[{"P", "(", 
     SubscriptBox["k", "1"], ")"}], 
    RowBox[{"P", "(", 
     SubscriptBox["k", "2"], ")"}], 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       RowBox[{"P", "(", "q", ")"}], "/", 
       SuperscriptBox["q", "2"]}], "d3q"}]}]}], TraditionalForm]],
  ExpressionUUID->"bf311d0b-22d4-4f5e-8513-81b9e58c8105"],
 "; additional divergences proportional to ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", 
     SubscriptBox["k", "1"], ")"}], 
    RowBox[{"P", "(", 
     SubscriptBox["k", "2"], ")"}], 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{"P", "(", "q", ")"}], "d3q"}]}]}], TraditionalForm]],
  ExpressionUUID->"4b8af5a1-01f0-4a52-8dc2-5cdf143f6ed6"],
 " vanish due to renormalization. Here, we recompute the (flattened) UV \
limits only if they are not already present in the output directory."
}], "Text",
 CellChangeTimes->{{3.854387651748549*^9, 3.854387775432374*^9}, {
  3.8544639936667337`*^9, 3.8544640361655397`*^9}, {3.861713331545642*^9, 
  3.8617133465138702`*^9}, {3.861715059929834*^9, 
  3.861715061226062*^9}},ExpressionUUID->"6f86706c-ec9d-47fc-8f2f-\
25168a438ea7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "\"\<b411uv-flat.wdx\>\"", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Load", " ", "in", " ", "explicit", " ", "limit"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Loading UV limit from file\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B411UVkernel", " ", "=", " ", 
      RowBox[{"Import", "[", "\"\<b411uv-flat.wdx\>\"", "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Recompute", " ", "from", " ", "scratch"}], ",", " ", 
      RowBox[{
      "and", " ", "print", " ", "each", " ", "term", " ", "for", " ", 
       "posterity"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Recomputing UV limit\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ker411expan", "=", 
      RowBox[{
       RowBox[{"ker411init", "/.", "muSubs"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B411UVkernel", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "biasListB411", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"lim", "=", 
         RowBox[{"limFullUV", "[", 
          RowBox[{"ker411expan", ",", 
           RowBox[{
           "biasListB411", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], ";", " ", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{
          "biasListB411", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "\"\<: \>\"", ",", "lim"}], "]"}], 
        ";", 
        RowBox[{"B411UVkernel", "+=", 
         RowBox[{"lim", " ", "*", " ", 
          RowBox[{
          "biasListB411", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Saving output\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<b411uv-flat.wdx\>\"", ",", "B411UVkernel"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.855167894985791*^9, 3.8551679075860033`*^9}, {
  3.858411582323738*^9, 3.858411582861623*^9}, {3.861713348305986*^9, 
  3.861713472159761*^9}, {3.8617150260077257`*^9, 3.861715053302684*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"e029082a-9940-41b2-a166-0b8332424863"],

Cell[BoxData["\<\"Loading UV limit from file\"\>"], "Print",
 CellChangeTimes->{{3.8617134613165483`*^9, 3.861713499146377*^9}, {
   3.86171510432159*^9, 3.861715120483247*^9}, 3.8617156527811604`*^9},
 CellLabel->
  "During evaluation of \
In[132]:=",ExpressionUUID->"378a7e96-9c29-4d55-af5a-34a9a85270e0"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{831, 857},
WindowMargins->{{10, Automatic}, {Automatic, 19}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1187, 30, 104, "Text",ExpressionUUID->"394eb258-9a60-49a5-8d1e-561b69b7a771"],
Cell[1748, 52, 966, 28, 73, "Input",ExpressionUUID->"c10a3ab8-894b-4555-bd84-11442c651e8e"],
Cell[CellGroupData[{
Cell[2739, 84, 151, 3, 67, "Section",ExpressionUUID->"eb149da2-3853-4ba3-94c1-468001582704"],
Cell[CellGroupData[{
Cell[2915, 91, 1034, 15, 45, "Subsubsection",ExpressionUUID->"d6cdec3d-978d-44a9-aaf5-5bae775f744a"],
Cell[3952, 108, 737, 21, 73, "Input",ExpressionUUID->"a48f6833-0977-4d92-ab3e-7f31de984de8"]
}, Closed]],
Cell[CellGroupData[{
Cell[4726, 134, 524, 13, 37, "Subsubsection",ExpressionUUID->"39158c7b-6178-4dbd-bd08-ccb6115dc873"],
Cell[5253, 149, 9758, 284, 680, "Input",ExpressionUUID->"13e1f143-955c-4fa4-b822-b0cf6ec6e9c5"]
}, Closed]],
Cell[CellGroupData[{
Cell[15048, 438, 499, 14, 37, "Subsubsection",ExpressionUUID->"c353478e-954e-4a3b-868c-ef7e2ffc8c48"],
Cell[15550, 454, 3685, 100, 166, "Text",ExpressionUUID->"b0529966-e19b-4965-9033-f4a380ffc2d0"],
Cell[19238, 556, 1958, 30, 52, "Input",ExpressionUUID->"0b4720e3-ba25-4320-b918-84287f55a45a"],
Cell[21199, 588, 184, 3, 35, "Text",ExpressionUUID->"44946857-4fa0-4b68-b2cf-f7efd3a3029e"],
Cell[21386, 593, 3550, 97, 202, "Input",ExpressionUUID->"9bcc5142-71b7-4f64-b11d-8da8dd6e3a72"],
Cell[24939, 692, 153, 3, 35, "Text",ExpressionUUID->"9f694f9c-3c9d-409f-8b6c-7477eb0022ad"],
Cell[25095, 697, 436, 11, 52, "Input",ExpressionUUID->"6d7210e6-2f2c-4a3c-8574-183cacff172b"],
Cell[25534, 710, 202, 4, 35, "Text",ExpressionUUID->"5555aa88-ec22-426f-a2f0-919e04449f52"],
Cell[25739, 716, 4502, 110, 226, "Input",ExpressionUUID->"01265db1-8372-49ab-b587-67d8550450e7"],
Cell[30244, 828, 218, 4, 35, "Text",ExpressionUUID->"c576a84e-16fe-4136-bf66-625bacbe80da"],
Cell[30465, 834, 5600, 165, 350, "Input",ExpressionUUID->"03d0fa56-0de3-4dcf-ad24-e6dec241274f"],
Cell[36068, 1001, 1829, 47, 127, "Text",ExpressionUUID->"e1997c2c-6a06-4fa8-8c9c-1ca10ac8fcc9"],
Cell[37900, 1050, 14137, 398, 947, "Input",ExpressionUUID->"b91cdb17-768a-411c-a63d-d8a771c8d0c8"]
}, Closed]],
Cell[CellGroupData[{
Cell[52074, 1453, 185, 3, 37, "Subsubsection",ExpressionUUID->"d82815db-1444-4c1c-b3cb-ec5fbb908aa5"],
Cell[52262, 1458, 678, 18, 58, "Text",ExpressionUUID->"4b98a41e-be79-4e5d-ba2d-c38ff880904f"],
Cell[52943, 1478, 6588, 181, 388, "Input",ExpressionUUID->"39a62a43-1edc-4d5a-93c0-f6de0aaa34fa"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59580, 1665, 159, 3, 67, "Section",ExpressionUUID->"028af50f-adbd-4fea-adb7-2d96df6d4c6e"],
Cell[59742, 1670, 234, 6, 35, "Text",ExpressionUUID->"1c2478c6-661c-4c8d-a615-97d1ec8d0880"],
Cell[CellGroupData[{
Cell[60001, 1680, 237, 4, 54, "Subsection",ExpressionUUID->"ae200576-0016-4450-9e5a-5a2369e59aa2"],
Cell[60241, 1686, 458, 12, 58, "Text",ExpressionUUID->"ad1ddfa8-d8d3-4a62-85b0-ab142f8bb0c0"],
Cell[CellGroupData[{
Cell[60724, 1702, 2048, 53, 159, "Input",ExpressionUUID->"4bc7bf35-5a77-4c05-99d8-d670345e4a30"],
Cell[62775, 1757, 395, 8, 24, "Print",ExpressionUUID->"4b3a5977-f49e-4479-ae4d-1a8175022a15"]
}, Open  ]],
Cell[63185, 1768, 2366, 64, 136, "Input",ExpressionUUID->"ec6816f9-da9a-4536-a8b8-c899b2a80889"]
}, Closed]],
Cell[CellGroupData[{
Cell[65588, 1837, 231, 4, 38, "Subsection",ExpressionUUID->"e0cd41f5-14ba-48a6-8c99-f0a2d273176d"],
Cell[65822, 1843, 1076, 27, 104, "Text",ExpressionUUID->"331795d0-3cfd-494c-92b3-e4f4556e80fb"],
Cell[CellGroupData[{
Cell[66923, 1874, 1727, 44, 115, "Input",ExpressionUUID->"c3e46801-42c6-4ec7-8424-c642aac833ff"],
Cell[68653, 1920, 472, 9, 24, "Print",ExpressionUUID->"0fc4a7cc-a43c-41cf-9d1e-edcc47eed1ea"]
}, Open  ]],
Cell[69140, 1932, 5158, 140, 342, "Input",ExpressionUUID->"92b9d2bf-eae8-4b46-be85-d606d7e653a7"],
Cell[CellGroupData[{
Cell[74323, 2076, 11924, 281, 1254, "Input",ExpressionUUID->"62623235-dd2b-4149-a14e-33c4da5dafc5"],
Cell[86250, 2359, 405, 7, 24, "Print",ExpressionUUID->"4ee369bb-f57c-4775-89e9-e39a74cd1b8d"]
}, Open  ]],
Cell[86670, 2369, 745, 15, 58, "Text",ExpressionUUID->"29f54ffa-694b-4253-a9a4-d038f502e1c1"],
Cell[CellGroupData[{
Cell[87440, 2388, 2858, 61, 161, "Input",ExpressionUUID->"e97588c7-df2c-4664-8517-a437fb0df8e8"],
Cell[90301, 2451, 1079, 33, 54, "Output",ExpressionUUID->"e616cdcc-5c21-4132-a27c-5de64c64b85a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[91429, 2490, 360, 6, 38, "Subsection",ExpressionUUID->"c35d043d-6527-47ce-8806-aeb233403bb5"],
Cell[91792, 2498, 704, 17, 84, "Text",ExpressionUUID->"95ac1deb-312c-443f-810a-6ba8a2bf24d7"],
Cell[CellGroupData[{
Cell[92521, 2519, 2055, 56, 138, "Input",ExpressionUUID->"58b1069c-ae01-4ee8-9506-2ca161fb16d1"],
Cell[94579, 2577, 1149, 19, 24, "Print",ExpressionUUID->"f8709785-dc7c-45e3-8a11-d78e1b4f1b88"]
}, Open  ]],
Cell[95743, 2599, 6300, 167, 399, "Input",ExpressionUUID->"15467d6d-21a7-4de2-9635-0a75cf80ce30"],
Cell[CellGroupData[{
Cell[102068, 2770, 20615, 512, 2074, "Input",ExpressionUUID->"94f96f1e-f933-48d1-9076-ab8290abdca5"],
Cell[122686, 3284, 383, 7, 24, "Print",ExpressionUUID->"ff2cc0c1-c5ec-483b-b25e-31efa7a02064"]
}, Open  ]],
Cell[123084, 3294, 229, 6, 35, "Text",ExpressionUUID->"e3feb235-a316-4a1a-8223-31928dc6027e"],
Cell[CellGroupData[{
Cell[123338, 3304, 1665, 36, 75, "Input",ExpressionUUID->"c45e8fb6-85fa-4e6a-9c27-e01165a92c8d"],
Cell[125006, 3342, 14691, 481, 821, "Output",ExpressionUUID->"c2be7c66-be49-4595-a7f3-be579263ff7b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[139746, 3829, 287, 5, 38, "Subsection",ExpressionUUID->"7a37b377-4fce-49a2-a667-95fc08ff3053"],
Cell[140036, 3836, 799, 19, 81, "Text",ExpressionUUID->"08ad6e44-e277-4204-b50e-bb16087bbd46"],
Cell[CellGroupData[{
Cell[140860, 3859, 2622, 68, 161, "Input",ExpressionUUID->"0959ea30-abfa-4d28-8631-5ebced952807"],
Cell[143485, 3929, 950, 16, 24, "Print",ExpressionUUID->"2f205b62-016c-4b0a-9b97-fea4197c1676"]
}, Open  ]],
Cell[144450, 3948, 20629, 541, 861, "Input",ExpressionUUID->"f445a5e4-095b-48f9-bb03-fc93544d8ff1"],
Cell[CellGroupData[{
Cell[165104, 4493, 107024, 2742, 7126, "Input",ExpressionUUID->"e3d51214-09ac-45b4-a8dd-20a0325b9f37"],
Cell[272131, 7237, 306, 5, 24, "Print",ExpressionUUID->"b4972ff7-e1cb-42fa-964d-d4cd0a4e83ea"]
}, Open  ]],
Cell[272452, 7245, 286, 6, 35, "Text",ExpressionUUID->"f12bc05f-5453-4cdd-b763-e8ab9a356cf8"],
Cell[CellGroupData[{
Cell[272763, 7255, 1481, 31, 77, "Input",ExpressionUUID->"bd7aa7e4-fc81-47ee-9bbd-9c405e106758"],
Cell[274247, 7288, 5180, 177, 262, "Output",ExpressionUUID->"1fd01550-a546-4b56-a951-e88633f9f361"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[279488, 7472, 337, 5, 67, "Section",ExpressionUUID->"0c171b24-0a9d-4774-a6f5-74ec0c1f4b10"],
Cell[279828, 7479, 1110, 24, 104, "Text",ExpressionUUID->"675f50e6-c17e-478a-a938-9d89f63f9d0a"],
Cell[CellGroupData[{
Cell[280963, 7507, 157, 3, 45, "Subsubsection",ExpressionUUID->"ddde4e00-d213-431d-a13c-861d5a1a76ca"],
Cell[281123, 7512, 529, 11, 52, "Input",ExpressionUUID->"8a41f9fa-071f-46d3-940d-96497226e6f2"],
Cell[281655, 7525, 18397, 431, 986, "Input",ExpressionUUID->"a710a6e8-5b5d-4785-9fd4-f419667949b7"]
}, Closed]],
Cell[CellGroupData[{
Cell[300089, 7961, 154, 3, 37, "Subsubsection",ExpressionUUID->"a90a1da6-a4ce-43ab-8880-8874f359a0cd"],
Cell[300246, 7966, 1608, 40, 60, "Text",ExpressionUUID->"4b331670-fd98-4c0c-9446-42e1db9fc7f6"],
Cell[301857, 8008, 292, 6, 30, "Input",ExpressionUUID->"2209cf69-d864-4329-bda0-e3ebfe0754d5"]
}, Closed]],
Cell[CellGroupData[{
Cell[302186, 8019, 205, 4, 37, "Subsubsection",ExpressionUUID->"0b3eb213-77cc-42c9-b5a8-b4c846c8b012"],
Cell[302394, 8025, 1025, 27, 60, "Text",ExpressionUUID->"18427ac0-643e-461a-931c-b5fa2e36beba"],
Cell[303422, 8054, 227, 5, 30, "Input",ExpressionUUID->"f6cc1764-0326-4c62-948f-537cb2c3c0a1"]
}, Closed]],
Cell[CellGroupData[{
Cell[303686, 8064, 155, 3, 37, "Subsubsection",ExpressionUUID->"69b3dd7a-bfb4-4249-b7dc-3d3550faf291"],
Cell[303844, 8069, 1451, 37, 108, "Text",ExpressionUUID->"6f86706c-ec9d-47fc-8f2f-25168a438ea7"],
Cell[CellGroupData[{
Cell[305320, 8110, 2724, 64, 367, "Input",ExpressionUUID->"e029082a-9940-41b2-a166-0b8332424863"],
Cell[308047, 8176, 307, 5, 24, "Print",ExpressionUUID->"378a7e96-9c29-4d55-af5a-34a9a85270e0"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

